import{Aa as ue,Ba as Pt,Ca as Vt,Da as De,Ea as It,Fa as Dt,G as Ve,Ga as F,H as X,Ha as kt,Ia as D,J as vt,Ja as Ft,T as $,U as z,V as q,W as St,X as bt,Y as xt,a as re,c as de,d as ce,ea as H,g as A,ha as yt,ia as j,k as I,ma as ee,p as Te,pa as pe,qa as Ct,r as Pe,ra as wt,s as K,sa as Et,ta as te,ua as G,va as me,wa as Ie,xa as Y,ya as Mt,za as Tt}from"./chunk-QDNMRTE6.js";import{$b as C,Ca as d,Db as ot,Gb as be,Ha as b,Ib as o,Jb as f,Kb as N,L as Se,Lb as at,Mb as lt,Na as k,Nb as h,Ob as g,Pb as _,Qb as _t,R as V,Sa as M,Sb as O,Tb as se,V as P,W as we,a as Ce,aa as p,b as ft,ba as m,d as Nt,e as Ht,fb as u,gb as t,hb as i,ib as w,l as le,mb as Ee,nb as Me,pb as T,t as ht,tb as S,ub as v}from"./chunk-T73Y6ZVN.js";var Bt=Nt((pt,mt)=>{(function(l,r){typeof define=="function"&&define.amd?define([],r):typeof pt<"u"?r():(r(),l.FileSaver={})})(pt,function(){"use strict";function l(x,y){return typeof y>"u"?y={autoBom:!1}:typeof y!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),y={autoBom:!y}),y.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(x.type)?new Blob(["\uFEFF",x],{type:x.type}):x}function r(x,y,B){var E=new XMLHttpRequest;E.open("GET",x),E.responseType="blob",E.onload=function(){s(E.response,y,B)},E.onerror=function(){console.error("could not download file")},E.send()}function e(x){var y=new XMLHttpRequest;y.open("HEAD",x,!1);try{y.send()}catch{}return 200<=y.status&&299>=y.status}function n(x){try{x.dispatchEvent(new MouseEvent("click"))}catch{var y=document.createEvent("MouseEvents");y.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),x.dispatchEvent(y)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,c=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(x,y,B){var E=a.URL||a.webkitURL,L=document.createElement("a");y=y||x.name||"download",L.download=y,L.rel="noopener",typeof x=="string"?(L.href=x,L.origin===location.origin?n(L):e(L.href)?r(x,y,B):n(L,L.target="_blank")):(L.href=E.createObjectURL(x),setTimeout(function(){E.revokeObjectURL(L.href)},4e4),setTimeout(function(){n(L)},0))}:"msSaveOrOpenBlob"in navigator?function(x,y,B){if(y=y||x.name||"download",typeof x!="string")navigator.msSaveOrOpenBlob(l(x,B),y);else if(e(x))r(x,y,B);else{var E=document.createElement("a");E.href=x,E.target="_blank",setTimeout(function(){n(E)})}}:function(x,y,B,E){if(E=E||open("","_blank"),E&&(E.document.title=E.document.body.innerText="downloading..."),typeof x=="string")return r(x,y,B);var L=x.type==="application/octet-stream",Ot=/constructor/i.test(a.HTMLElement)||a.safari,ut=/CriOS\/[\d]+/.test(navigator.userAgent);if((ut||L&&Ot||c)&&typeof FileReader<"u"){var nt=new FileReader;nt.onloadend=function(){var ve=nt.result;ve=ut?ve:ve.replace(/^data:[^;]*;/,"data:attachment/file;"),E?E.location.href=ve:location=ve,E=null},nt.readAsDataURL(x)}else{var gt=a.URL||a.webkitURL,rt=gt.createObjectURL(x);E?E.location=rt:location.href=rt,E=null,setTimeout(function(){gt.revokeObjectURL(rt)},4e4)}});a.saveAs=s.saveAs=s,typeof mt<"u"&&(mt.exports=s)})});var ke=class{codigo_et;empresa;estado};var oe=class{id_vehiculo;codigo_et;tipo;marca;estado;placa;alto;ancho;largo;constancia;configuracion_vehicular;peso_max_permitido};var R=class l{constructor(r,e){this.http=r;this.url=e}findAll(){return this.http.get(this.url)}findById(r){return this.http.get(`${this.url}/${r}`)}save(r){return this.http.post(this.url,r)}update(r,e){return this.http.put(`${this.url}/${r}`,e)}delete(r){return this.http.delete(`${this.url}/${r}`)}static \u0275fac=function(e){return new(e||l)(P(I),P("url"))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var ge=class l extends R{constructor(e){super(e,`${D.HOST}/vehiculos`);this.http=e}vehiculoChnage=new le;listarVehiculos(){return this.http.get(`${this.url}/buscar`)}setVehiculoChange(e){this.vehiculoChnage.next(e)}getVehiculoChange(){return this.vehiculoChnage.asObservable()}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var Fe=class l extends R{constructor(e){super(e,`${D.HOST}/empresaTransportes`);this.http=e}listarEmpresaTransporte(){return this.http.get(`${this.url}/buscar`)}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var Ut=()=>["idVehiculo","empresa","placa","marca","tipo","alto","ancho","largo","constancia","configuracion","permitido"],zt=()=>({width:"600px"}),qt=()=>({width:"700px"}),Kt=()=>["codigoEt","empresa","estado"];function Xt(l,r){if(l&1){let e=T();t(0,"p-button",14),S("click",function(){p(e);let a=v();return m(a.abrirNuevo())}),i()}}function Yt(l,r){if(l&1){let e=T();t(0,"div",15)(1,"h5",16),o(2,"Gestion de Vehiculos"),i(),t(3,"p-iconfield"),w(4,"p-inputicon",17),t(5,"input",18),S("input",function(a){p(e);let c=v(),s=ot(5);return m(c.filtrarVehiculos(s,a))}),i()()()}}function Jt(l,r){l&1&&(t(0,"tr")(1,"th"),o(2,"Id"),i(),t(3,"th"),o(4,"Empresa Transporte"),i(),t(5,"th"),o(6,"Placa"),i(),t(7,"th"),o(8,"Marca"),i(),t(9,"th"),o(10,"Tipo"),i(),t(11,"th"),o(12,"Alto"),i(),t(13,"th"),o(14,"Ancho"),i(),t(15,"th"),o(16,"Largo"),i(),t(17,"th"),o(18,"Constancia"),i(),t(19,"th"),o(20,"Conf. Vehicular"),i(),t(21,"th"),o(22,"Peso Max Perm.(TN)"),i(),t(23,"th"),o(24,"Acciones"),i()())}function Zt(l,r){if(l&1){let e=T();t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),o(14),i(),t(15,"td"),o(16),i(),t(17,"td"),o(18),i(),t(19,"td"),o(20),i(),t(21,"td"),o(22),i(),t(23,"td")(24,"p-button",19),S("click",function(){let a=p(e).$implicit,c=v();return m(c.editarVehiculo(a))}),i()()()}if(l&2){let e=r.$implicit;d(2),f(e.idVehiculo),d(2),f(e.empresa),d(2),f(e.placa),d(2),f(e.marca),d(2),f(e.tipo),d(2),f(e.alto),d(2),f(e.ancho),d(2),f(e.largo),d(2),f(e.constancia),d(2),f(e.configuracion),d(2),f(e.permitido),d(2),u("rounded",!0)("outlined",!0)}}function Qt(l,r){if(l&1){let e=T();Ee(0),t(1,"div",26)(2,"div",21)(3,"label",31),o(4,"Peso. Max Permi: "),i(),t(5,"input",40),_("ngModelChange",function(a){p(e);let c=v(2);return g(c.peso_max,a)||(c.peso_max=a),m(a)}),i()(),t(6,"div",21)(7,"label",22),o(8,"Conf. Vehicular:"),i(),t(9,"input",41),_("ngModelChange",function(a){p(e);let c=v(2);return g(c.confg_Vehicular,a)||(c.confg_Vehicular=a),m(a)}),i()()(),Me()}if(l&2){let e=v(2);d(5),h("ngModel",e.peso_max),d(4),h("ngModel",e.confg_Vehicular)}}function $t(l,r){if(l&1){let e=T();t(0,"p-fluid")(1,"div",20)(2,"div",21)(3,"label",22),o(4,"Placa:"),i(),t(5,"input",23),_("ngModelChange",function(a){p(e);let c=v();return g(c.idVehiculo,a)||(c.idVehiculo=a),m(a)}),i(),t(6,"input",24),_("ngModelChange",function(a){p(e);let c=v();return g(c.placa,a)||(c.placa=a),m(a)}),i()(),t(7,"div",21)(8,"label",22),o(9,"Alto:"),i(),t(10,"input",25),_("ngModelChange",function(a){p(e);let c=v();return g(c.alto,a)||(c.alto=a),m(a)}),i()()(),t(11,"div",26)(12,"div",21)(13,"label",22),o(14,"Marca:"),i(),t(15,"input",27),_("ngModelChange",function(a){p(e);let c=v();return g(c.marca,a)||(c.marca=a),m(a)}),i()(),t(16,"div",21)(17,"label",22),o(18,"Ancho:"),i(),t(19,"input",28),_("ngModelChange",function(a){p(e);let c=v();return g(c.ancho,a)||(c.ancho=a),m(a)}),i()()(),t(20,"div",26)(21,"div",21)(22,"label",22),o(23,"Tarj. U.C o C.H.V.E.:"),i(),t(24,"input",29),_("ngModelChange",function(a){p(e);let c=v();return g(c.constancia,a)||(c.constancia=a),m(a)}),i()(),t(25,"div",21)(26,"label",22),o(27,"Largo:"),i(),t(28,"input",30),_("ngModelChange",function(a){p(e);let c=v();return g(c.largo,a)||(c.largo=a),m(a)}),i()()(),t(29,"div",26)(30,"div",21)(31,"label",31),o(32,"Tipo: "),i(),t(33,"p-select",32),_("ngModelChange",function(a){p(e);let c=v();return g(c.tipoSeleccionado,a)||(c.tipoSeleccionado=a),m(a)}),i()()(),M(34,Qt,10,2,"ng-container",33),w(35,"p-divider"),t(36,"div",26)(37,"label",34),o(38,"Empresa Transporte: "),i(),t(39,"div",35)(40,"p-iconfield",36)(41,"input",37),_("ngModelChange",function(a){p(e);let c=v();return g(c.empresaSeleccionado.empresa,a)||(c.empresaSeleccionado.empresa=a),m(a)}),i(),t(42,"p-inputicon",38),S("click",function(){p(e);let a=v();return m(a.abrirEmpresaTransporte())}),i()(),t(43,"input",39),_("ngModelChange",function(a){p(e);let c=v();return g(c.empresaSeleccionado.codigoEt,a)||(c.empresaSeleccionado.codigoEt=a),m(a)}),i()()()()}if(l&2){let e=v();d(5),h("ngModel",e.idVehiculo),u("hidden",!0),d(),h("ngModel",e.placa),d(4),h("ngModel",e.alto),d(5),h("ngModel",e.marca),d(4),h("ngModel",e.ancho),d(5),h("ngModel",e.constancia),d(4),h("ngModel",e.largo),d(5),h("ngModel",e.tipoSeleccionado),u("options",e.tipo),d(),u("ngIf",e.tipoSeleccionado!=="Remolque"),d(7),h("ngModel",e.empresaSeleccionado.empresa),d(2),h("ngModel",e.empresaSeleccionado.codigoEt),u("hidden",!0)}}function ei(l,r){if(l&1){let e=T();t(0,"p-button",42),S("click",function(){p(e);let a=v();return m(a.saveVehiculo())}),i(),w(1,"p-button",43)}}function ti(l,r){l&1&&(t(0,"tr")(1,"th"),o(2,"Id"),i(),t(3,"th"),o(4,"Nombre"),i(),t(5,"th"),o(6,"Estado"),i()())}function ii(l,r){if(l&1&&(t(0,"tr",54)(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i()()),l&2){let e=r.$implicit;u("pSelectableRow",e),d(2),f(e.codigoEt),d(2),f(e.empresa),d(2),f(e.estado)}}function ni(l,r){if(l&1){let e=T();t(0,"p-fluid")(1,"p-toolbar",44)(2,"div",45)(3,"label",46),o(4,"Buscar:"),i(),t(5,"div",47)(6,"div",48)(7,"input",49),S("input",function(a){p(e);let c=ot(11),s=v();return m(s.filtrarEmpresas(c,a))}),i()(),t(8,"div",50),w(9,"button",51),i()()()(),t(10,"p-table",52,7),_("selectionChange",function(a){p(e);let c=v();return g(c.seleccionarFila,a)||(c.seleccionarFila=a),m(a)}),M(12,ti,7,0,"ng-template",null,3,C)(14,ii,7,4,"ng-template",null,4,C),i(),t(16,"p-button",53),S("onClick",function(){p(e);let a=v();return m(a.seleccionarEmpresaTransp())}),i()()}if(l&2){let e=v();d(10),u("value",e.empresa)("rows",5)("paginator",!0),h("selection",e.seleccionarFila),u("globalFilterFields",O(6,Kt)),d(6),u("fluid",!1)}}var Re=class l{constructor(r,e,n){this.vehiculoService=r;this.empresaTransporteService=e;this.service=n}vehiculos=[];vehiculoDialog=!1;empresaTransporteDialog=!1;vehiculo;tipoSeleccionado;empresa=[];seleccionarFila={};empresaSeleccionado={};tipo;titulo;idVehiculo;placa;alto;marca;ancho;constancia;largo;peso_max;confg_Vehicular;codigo_et;ngOnInit(){this.tipo=[{label:"Camion",value:"Camion"},{label:"Remolcador",value:"Remolcador"},{label:"Volquete",value:"Volquete"},{label:"Camioneta",value:"Camioneta"},{label:"Remolque",value:"Remolque"},{label:"Moto Cargo",value:"Moto Cargo"}],this.vehiculoService.listarVehiculos().subscribe(r=>{this.createTable(r),console.log(r)}),this.vehiculoService.getVehiculoChange().subscribe(r=>this.createTable(r))}createTable(r){this.vehiculos=r}abrirNuevo(){this.titulo="REGISTRAR VEHICULO",this.vehiculoDialog=!0}abrirEmpresaTransporte(){this.empresaTransporteDialog=!0,this.listarEmpresaTrasport()}listarEmpresaTrasport(){this.empresaTransporteService.listarEmpresaTransporte().subscribe(r=>{this.empresa=r})}seleccionarEmpresaTransp(){this.seleccionarFila&&this.seleccionarFila.codigoEt&&(this.empresaSeleccionado=Ce({},this.seleccionarFila),this.empresaTransporteDialog=!1)}saveVehiculo(){let r=new ke;r.codigo_et=this.empresaSeleccionado.codigoEt;let e=new oe;e.id_vehiculo=this.idVehiculo,e.codigo_et=r,e.tipo=this.tipoSeleccionado,e.marca=this.marca,e.estado="ACTIVO",e.placa=this.placa,e.alto=this.alto,e.ancho=this.ancho,e.largo=this.largo,e.constancia=this.constancia,e.configuracion_vehicular=this.confg_Vehicular,e.peso_max_permitido=this.peso_max,e.id_vehiculo?this.vehiculoService.update(this.idVehiculo,e).pipe(Se(()=>this.vehiculoService.listarVehiculos())).subscribe({next:n=>{this.vehiculoService.setVehiculoChange(n),this.service.add({severity:"info",summary:"Notificaci\xF3n",detail:"Datos actualizado Correctamente",life:6e3})},error:()=>{this.service.add({severity:"error",summary:"Error",detail:"No registrado",life:6e3})}}):this.vehiculoService.save(e).pipe(Se(()=>this.vehiculoService.listarVehiculos())).subscribe({next:n=>{this.vehiculoService.setVehiculoChange(n),this.service.add({severity:"success",summary:"Correcto",detail:"Evaluacion registrada correctamente!",life:6e3})},error:()=>{this.service.add({severity:"error",summary:"Error",detail:"No registrado",life:6e3})}}),this.vehiculoDialog=!1,this.resetFormulario()}editarVehiculo(r){this.idVehiculo=r.idVehiculo,this.placa=r.placa,this.alto=r.alto,this.marca=r.marca,this.ancho=r.ancho,this.constancia=r.constancia,this.largo=r.largo,this.tipoSeleccionado=r.tipo,this.peso_max=r.permitido,this.confg_Vehicular=r.configuracion,this.empresaSeleccionado={empresa:r.empresa,codigoEt:r.codigoEt||""},this.titulo="Editar Veh\xEDculo",this.vehiculoDialog=!0}resetFormulario(){this.idVehiculo=0,this.placa="",this.alto="",this.marca="",this.ancho="",this.constancia="",this.largo="",this.tipoSeleccionado="",this.peso_max=null,this.confg_Vehicular="",this.empresaSeleccionado={empresa:"",codigoEt:""}}filtrarVehiculos(r,e){r.filterGlobal(e.target.value,"contains")}filtrarEmpresas(r,e){r.filterGlobal(e.target.value,"contains")}static \u0275fac=function(e){return new(e||l)(b(ge),b(Fe),b(X))};static \u0275cmp=k({type:l,selectors:[["app-vehiculo"]],decls:21,vars:20,consts:[["start",""],["dtvehiculo",""],["caption",""],["header",""],["body",""],["content",""],["footer",""],["dtempresa",""],[1,"card"],[1,"mb-6"],["currentPageReportTemplate","Mostrando {first} to {last} de {totalRecords} vehiculos",3,"value","rowHover","showCurrentPageReport","rows","paginator","globalFilterFields"],[3,"visibleChange","visible","header","modal"],["header","Buscar Empresa Transporte",3,"visibleChange","visible","modal"],["position","top-right"],["label","Nuevo","icon","pi pi-plus",1,"mr-2",3,"click"],[1,"flex","items-center","justify-between"],[1,"m-0"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["icon","pi pi-pencil",1,"mr-2",3,"click","rounded","outlined"],[1,"flex","flex-col","md:flex-row","gap-6"],[1,"flex","flex-wrap","gap-2","w-full"],["for","numTicket"],["pInputText","","id","id_vehiculo","type","text",3,"ngModelChange","ngModel","hidden"],["pInputText","","id","numTicket","type","text","placeholder","X6Y-985",3,"ngModelChange","ngModel"],["pInputText","","id","numTicket","type","text","placeholder","3.60",3,"ngModelChange","ngModel"],[1,"flex","flex-col","md:flex-row","gap-6","mt-3"],["pInputText","","id","numTicket","type","text","placeholder","VOLVO",3,"ngModelChange","ngModel"],["pInputText","","id","numTicket","type","text","placeholder","2.10",3,"ngModelChange","ngModel"],["pInputText","","id","numTicket","type","text","placeholder","15M24054E",3,"ngModelChange","ngModel"],["pInputText","","id","numTicket","type","text","placeholder","5.40",3,"ngModelChange","ngModel"],["for","state"],["id","state","optionLabel","label","optionValue","value","placeholder","Seeleccionar","appendTo","body",1,"w-full",3,"ngModelChange","ngModel","options"],[4,"ngIf"],["for","email3",1,"flex"],[1,"w-full"],["iconPosition","left"],["pInputText","","type","text","placeholder","TRANSPORTE PAUCARS",3,"ngModelChange","ngModel"],[1,"pi","pi-search",2,"cursor","pointer",3,"click"],["pInputText","","type","text",3,"ngModelChange","ngModel","hidden"],["pInputText","","id","numTicket","type","text","placeholder","51.420",3,"ngModelChange","ngModel"],["pInputText","","id","numTicket","type","text","placeholder","T3S",3,"ngModelChange","ngModel"],["label","Guardar","icon","pi pi-check",3,"click"],["label","Cancel","icon","pi pi-times","text",""],[1,"mb-2"],[1,"grid","grid-cols-12","gap-4","items-center"],["for","name3",1,"col-span-12","md:col-span-3"],[1,"col-span-12","md:col-span-9","flex","gap-2"],[1,"flex-grow"],["pInputText","","id","name3","type","text",1,"w-full",3,"input"],[2,"flex","0 0 auto"],["pButton","","type","button","label","Buscar",1,"p-button","p-button-info"],["selectionMode","single","dataKey","codigoEt",3,"selectionChange","value","rows","paginator","selection","globalFilterFields"],["icon","pi pi-check","label","Seleccionar",3,"onClick","fluid"],[3,"pSelectableRow"]],template:function(e,n){if(e&1){let a=T();t(0,"div",8)(1,"p-toolbar",9),M(2,Xt,1,0,"ng-template",null,0,C),i(),t(4,"p-table",10,1),M(6,Yt,6,0,"ng-template",null,2,C)(8,Jt,25,0,"ng-template",null,3,C)(10,Zt,25,13,"ng-template",null,4,C),i()(),t(12,"p-dialog",11),_("visibleChange",function(s){return p(a),g(n.vehiculoDialog,s)||(n.vehiculoDialog=s),m(s)}),M(13,$t,44,14,"ng-template",null,5,C)(15,ei,2,0,"ng-template",null,6,C),i(),t(17,"p-dialog",12),_("visibleChange",function(s){return p(a),g(n.empresaTransporteDialog,s)||(n.empresaTransporteDialog=s),m(s)}),M(18,ni,17,7,"ng-template",null,5,C),i(),w(20,"p-toast",13)}e&2&&(d(4),u("value",n.vehiculos)("rowHover",!0)("showCurrentPageReport",!0)("rows",10)("rowHover",!0)("paginator",!0)("globalFilterFields",O(17,Ut)),d(8),be(O(18,zt)),u("header",_t(n.titulo)),h("visible",n.vehiculoDialog),u("modal",!0),d(5),be(O(19,qt)),h("visible",n.empresaTransporteDialog),u("modal",!0))},dependencies:[F,G,Ie,yt,j,H,ee,$,z,q,te,Y,Ct,wt,ue,Pt,Vt,A,ce],encapsulation:2})};var U=class l extends R{constructor(e){super(e,`${D.HOST}/peso`);this.http=e}listarTicketsPorEstado(){return this.http.get(`${this.url}/destarar`)}listarPesajePorId(e){return this.http.get(`${this.url}/${e}`)}searchByDate(e){return this.http.get(`${this.url}/search/date?date=${e}`)}searchByProveedorAnioMes(e,n,a){return this.http.get(`${this.url}/buscar/${e}/${n}/${a}`)}listarPesajePorNumTicket(e){return this.http.get(`${this.url}/search/ticket/${e}`)}buscarHastaHora(e){return this.http.get(`${this.url}/prueba/date`,{params:{date:e}})}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};function ri(l,r){if(l&1&&(t(0,"div",6)(1,"div",7)(2,"div")(3,"span",8),o(4),i(),t(5,"div",9),o(6),i()(),t(7,"div",10),w(8,"i",11),i()(),t(9,"span",12),o(10),i()()),l&2){let e=r.$implicit,n=v();d(4),f(e.tipoOperacion),d(2),f(n.kgAToneladas(e.pesoNeto)),d(4),f(e.descripcion)}}var Ae=class l{constructor(r){this.pesodestareService=r}resultados=[];fechaHoraActual;newFechaHoraActual;ngOnInit(){this.setFechaHoraActual(),this.pesodestareService.buscarHastaHora(this.fechaHoraActual).subscribe(e=>{this.resultados=e});let r=new Date().toLocaleString("es-PE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0});this.newFechaHoraActual=r}setFechaHoraActual(){let r=new Date;this.fechaHoraActual=r.getFullYear()+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0")+"T"+String(r.getHours()).padStart(2,"0")+":"+String(r.getMinutes()).padStart(2,"0")+":"+String(r.getSeconds()).padStart(2,"0")}kgAToneladas(r){return r/1e3}static \u0275fac=function(e){return new(e||l)(b(U))};static \u0275cmp=k({type:l,selectors:[["app-dashboard"]],decls:7,vars:2,consts:[[1,"grid","gap-8"],[1,"flex"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],[1,"grid","grid-cols-1","md:grid-cols-2","xl:grid-cols-4","gap-6"],["class","card flex flex-col justify-between h-48 transition-shadow shadow-md hover:shadow-xl",4,"ngFor","ngForOf"],[1,"card","flex","flex-col","justify-between","h-48","transition-shadow","shadow-md","hover:shadow-xl"],[1,"flex","justify-between","mb-4"],[1,"block","text-muted-color","font-medium","mb-4"],[1,"text-surface-900","dark:text-surface-0","font-medium","text-xl"],[1,"flex","items-center","justify-center","bg-green-100","dark:bg-green-400/10","rounded-border","w-10","h-10"],[1,"pi","pi-dollar","text-green-500","text-xl"],[1,"text-muted-color"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),o(4),i(),t(5,"div",4),M(6,ri,11,3,"div",5),i()()()()),e&2&&(d(4),N("Informaci\xF3n de Balanza: ",n.newFechaHoraActual),d(2),u("ngForOf",n.resultados))},dependencies:[F,A,de],encapsulation:2})};var oi=()=>({"min-width":"60rem"}),ai=l=>["/pages/registrar-evaluacion",l];function li(l,r){if(l&1){let e=T();t(0,"div",5)(1,"span",6),o(2,"Pesos Pendientes"),i(),t(3,"p-button",7),S("click",function(){p(e);let a=v();return m(a.recargarDatos())}),i()()}}function si(l,r){l&1&&(t(0,"tr")(1,"th"),o(2,"NumTicket"),i(),t(3,"th"),o(4,"Proveedor"),i(),t(5,"th"),o(6,"Vehiculo"),i(),t(7,"th"),o(8,"Transportista"),i(),t(9,"th"),o(10,"Acciones"),i()())}function di(l,r){if(l&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),w(10,"p-button",8),i()()),l&2){let e=r.$implicit;d(2),f(e.numTicket),d(2),f(e.proveedor),d(2),f(e.placa),d(2),f(e.transportista),d(2),u("routerLink",se(5,ai,e.idPesaje))}}var Be=class l{constructor(r){this.pesoDestareService=r}pesoDestare;cargando=!1;ngOnInit(){this.pesoDestareService.listarTicketsPorEstado().subscribe(r=>{this.pesoDestare=r})}recargarDatos(){window.location.reload()}static \u0275fac=function(e){return new(e||l)(b(U))};static \u0275cmp=k({type:l,selectors:[["app-evaluacion-calidad"]],decls:8,vars:3,consts:[["caption",""],["header",""],["body",""],[1,"card"],[3,"value","tableStyle"],[1,"flex","items-center","justify-between"],[1,"text-xl","font-bold"],["icon","pi pi-refresh","rounded","","raised","",3,"click"],["label","Registrar","routerLinkActive","router-link-active",3,"routerLink"]],template:function(e,n){e&1&&(t(0,"div",3)(1,"p-table",4),M(2,li,4,0,"ng-template",null,0,C)(4,si,11,0,"ng-template",null,1,C)(6,di,11,7,"ng-template",null,2,C),i()()),e&2&&(d(),u("value",n.pesoDestare)("tableStyle",O(2,oi)))},dependencies:[F,G,j,K,A],encapsulation:2})};var Le=class{id_control;id_pesaje;campa\u00F1a;tipo_racimo;condicion;usuario};var Oe=class{id_criterio;codigo_um;descripcion;castigo;forma_castigo;factor_castigo;factor_variable;impresion_ticket;estado;usuario};var Ne=class{id_evaluacion;id_pesaje;id_criterio;valor;codigo_um;castigo;forma_castigo;factor_castigo;usuario;estado;usuario_mod;fecha_mod;tam_rac};var ae=class{id_pesaje;num_ticket;tipo_operacion;id_to;codigo;fecha;peso_ingreso;peso_salida;peso_neto;castigo_peso;castigo_planilla;id_vehiculo;codigoEt;conductor;id_parcela;cod_producto;estado;retencion_flete;monto_flete;tipo_registro;observaciones;version;id_liquidacion;usuario_ingreso;usuario_salida;usuario_version;fecha_salida;fecha_anul;bitacora;estado_sinc;reg_guia;serie;numero};var He=class l{constructor(r){this.http=r}url=`${D.HOST}/criterioCalidades`;listarCriterioCalidad(){return this.http.get(this.url)}static \u0275fac=function(e){return new(e||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var Ge=class l extends R{constructor(e){super(e,`${D.HOST}/evaluacion_calidad`);this.http=e}evaluacionCalidadChange=new le;listarEvaluacionPorIdPesaje(e){return this.http.get(`${this.url}/buscar/${e}`)}eliminarEvaluacionCalidad(e){return this.http.put(`${this.url}/delete/${e}`,{},{responseType:"text"})}setEvaluacionCalidadChange(e){this.evaluacionCalidadChange.next(e)}getEvaluacionCalidadChange(){return this.evaluacionCalidadChange.asObservable()}existsActivoByPesajeAndCriterio(e,n){return this.http.get(`${this.url}/existe/${e}/${n}`)}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var Ue=class l extends R{constructor(e){super(e,`${D.HOST}/controlrff`);this.http=e}buscarPorByIdPesaje(e){return this.http.get(`${this.url}/buscar/${e}`)}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var gi=()=>({"min-width":"60rem"}),fi=()=>({position:"absolute",top:"20px",left:"50%",transform:"translateX(-50%)"}),hi=()=>({"max-height":"200px",overflow:"auto"});function _i(l,r){l&1&&(t(0,"tr")(1,"th"),o(2,"Criterio"),i(),t(3,"th"),o(4,"Valor"),i(),t(5,"th"),o(6,"UM"),i(),t(7,"th"),o(8,"Peso Prom."),i(),t(9,"th"),o(10,"Total"),i(),t(11,"th"),o(12,"Acciones"),i()())}function vi(l,r){if(l&1){let e=T();t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td")(12,"p-button",29),S("click",function(){p(e);let a=v();return m(a.subirArchivo())}),i(),t(13,"p-button",30),S("onClick",function(){let a=p(e).$implicit,c=v();return m(c.eliminarEvaCalidad(a.id_evaluacion))}),i(),w(14,"p-toast"),i()()}if(l&2){let e=r.$implicit,n=v();d(2),f(e.id_criterio.descripcion),d(2),f(e.valor),d(2),f(e.codigo_um),d(2),f(e.factor_castigo),d(2),f(n.redondear(e.factor_castigo*e.valor)),d(2),u("rounded",!0)("text",!0),d(),u("rounded",!0)("text",!0)}}function Si(l,r){if(l&1&&(t(0,"li"),o(1),i()),l&2){let e=r.$implicit;d(),f(e)}}var ze=class l{constructor(r,e,n,a,c,s,x){this.criterioCalidadService=r;this.pesoDestareService=e;this.route=n;this.evaluacionCalidadService=a;this.service=c;this.controRffService=s;this.confirmationService=x}limpieza=[];tipoRacimo=[];criterio_calidad=[];evaluacion_calidad=[];dropdownItems=[{name:"Option 1",code:"Option 1"},{name:"Option 2",code:"Option 2"},{name:"Option 3",code:"Option 3"}];mostrarErrores=!1;errores=[];dropdownItem=null;idPesaje;transportista;numTicket;placa;proveedor;codigo_um;forma_castigo;castigo;factor_castigo;valor;isEdit;selectedValue;campana;racimoSeleccionado;limpiezaSeleccionado;ngOnInit(){this.criterioCalidadService.listarCriterioCalidad().subscribe(r=>this.criterio_calidad=r),this.limpieza=[{label:"Limpio",value:"Limpio"},{label:"Sucio",value:"Sucio"}],this.tipoRacimo=[{label:"Muy Peque\xF1o",value:"Muy Peque\xF1o"},{label:"Peque\xF1o",value:"Peque\xF1o"},{label:"Mediano",value:"Mediano"},{label:"Grande",value:"Grande"}],this.route.params.subscribe(r=>{this.idPesaje=r.id_pesaje,this.isEdit=r.id_pesaje!=null,this.cargarDatos()}),this.evaluacionCalidadService.listarEvaluacionPorIdPesaje(this.idPesaje).subscribe(r=>{this.createTable(r)}),this.evaluacionCalidadService.getEvaluacionCalidadChange().subscribe(r=>this.createTable(r)),this.controRffService.buscarPorByIdPesaje(this.idPesaje).subscribe(r=>{if(r){let e=r[0];this.campana=e.campa\u00F1a,this.racimoSeleccionado=this.tipoRacimo.find(n=>n.value===e.tipo_racimo)||null,this.limpiezaSeleccionado=this.limpieza.find(n=>n.value===e.condicion)||null}else this.campana=""})}createTable(r){this.evaluacion_calidad=r}cargarDatos(){this.pesoDestareService.listarPesajePorId(this.idPesaje).subscribe(r=>{this.numTicket=r.numTicket,this.proveedor=r.proveedor,this.transportista=r.transportista})}seleccionar(){let r=this.criterio_calidad.find(e=>e.id_criterio===this.selectedValue);r&&(this.codigo_um=r.codigo_um.codigo_um,this.forma_castigo=r.forma_castigo,this.castigo=r.castigo,this.factor_castigo=r.factor_castigo)}registrarEvaluacionCalidad(){let r=new ae;r.id_pesaje=this.idPesaje;let e=new Oe;e.id_criterio=this.selectedValue;let n=new Ne;n.id_pesaje=r,n.id_criterio=e,n.valor=this.valor,n.codigo_um=this.codigo_um,n.castigo=this.castigo,n.forma_castigo=this.forma_castigo,n.factor_castigo=""+this.factor_castigo,n.usuario="VEUSEBIO",n.fecha_mod=null,n.usuario_mod=null,n.estado="Activo",n.tam_rac=null,this.evaluacionCalidadService.existsActivoByPesajeAndCriterio(this.idPesaje,this.selectedValue).subscribe(a=>{a?this.service.add({severity:"error",summary:"Error",detail:"El criterio ya est\xE1 a\xF1adido",life:6e3}):this.evaluacionCalidadService.save(n).pipe(Se(()=>this.evaluacionCalidadService.listarEvaluacionPorIdPesaje(this.idPesaje))).subscribe(c=>{this.evaluacionCalidadService.setEvaluacionCalidadChange(c),this.service.add({severity:"success",summary:"Correcto",detail:"Evaluacion registrada correctamente!",life:6e3})}),this.limpiarCampos()})}limpiarCampos(){this.selectedValue=0,this.valor=null,this.factor_castigo=null}redondear(r){return Math.round(r)}subirArchivo(){this.service.add({severity:"info",summary:"Error Message",detail:"funcionalidad en desarrollo"})}eliminarEvaCalidad(r){this.confirmationService.confirm({target:event.target,message:"Esta seguro que quiere eliminar?",header:"Eliminacion de Evaluacion",closable:!0,closeOnEscape:!0,icon:"pi pi-exclamation-triangle",rejectButtonProps:{label:"Cancelar",severity:"secondary",outlined:!0},acceptButtonProps:{label:"Si"},accept:()=>{this.evaluacionCalidadService.eliminarEvaluacionCalidad(r).subscribe(()=>{this.evaluacionCalidadService.listarEvaluacionPorIdPesaje(this.idPesaje).subscribe(e=>{this.evaluacionCalidadService.setEvaluacionCalidadChange(e)})}),this.service.add({severity:"info",summary:"Confirmado",detail:"Registro eliminado",life:6e3})}})}saveControlRff(){let r=new ae;r.id_pesaje=this.idPesaje;let e=new Le;e.id_pesaje=r,e.campa\u00F1a=this.campana,e.tipo_racimo=this.racimoSeleccionado.value,e.condicion=this.limpiezaSeleccionado.value,this.controRffService.buscarPorByIdPesaje(this.idPesaje).subscribe(n=>{!n||n.length===0?this.controRffService.save(e).subscribe(()=>{this.service.add({severity:"info",summary:"Notificaci\xF3n",detail:"Datos Guardado Correctamente",life:6e3})}):this.controRffService.update(n[0].id_control,e).subscribe(()=>{this.service.add({severity:"info",summary:"Notificaci\xF3n",detail:"Datos Guardado Correctamente",life:6e3})})})}validarFormulario(){if(this.errores=[],this.selectedValue||this.errores.push("No se ha seleccionado el criterio."),(!this.valor||this.valor<=0)&&this.errores.push("No se ha ingresado el valor."),this.errores.length>0){this.mostrarErrores=!0;return}this.registrarEvaluacionCalidad()}static \u0275fac=function(e){return new(e||l)(b(He),b(U),b(Te),b(Ge),b(X),b(Ue),b(Ve))};static \u0275cmp=k({type:l,selectors:[["app-registrar-evaluacion"]],decls:66,vars:32,consts:[["header",""],["body",""],[1,"flex"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],[1,"flex","flex-col","md:flex-row","gap-6"],[1,"flex","flex-wrap","gap-2","w-full"],["for","firstname2"],["pInputText","","id","firstname2","type","text",3,"ngModelChange","ngModel","disabled"],["for","lastname2"],["pInputText","","id","lastname2","type","text",3,"ngModelChange","ngModel","disabled"],[1,"flex","mt-4"],["for","state"],["id","state","optionLabel","descripcion","optionValue","id_criterio","placeholder","Seleccionar ","required","",1,"w-full",3,"ngModelChange","ngModel","options"],["for","zip"],["pInputText","","id","zip","type","number",3,"ngModelChange","ngModel"],["pInputText","","id","zip","type","text",3,"ngModelChange","ngModel","disabled"],["label","Guardar Evaluacion",3,"onClick","fluid"],[1,"flex","flex-col","gap-6"],[3,"value","tableStyle"],["pInputText","","id","zip","type","text",3,"ngModelChange","ngModel"],["id","state","optionLabel","label","placeholder","Seleccionar",1,"w-full",3,"ngModelChange","ngModel","options"],["id","state","optionLabel","label","placeholder","Seeleccionar",1,"w-full",3,"ngModelChange","ngModel","options"],["label","Guardar adicionales",3,"click","fluid"],["label","Regresar","severity","secondary",3,"fluid"],["header","Errores de Validaci\xF3n",3,"visibleChange","visible","modal","closable","contentStyle","baseZIndex"],[1,"list-disc","pl-4"],[4,"ngFor","ngForOf"],["position","top-right"],["icon","pi pi-upload","severity","info",3,"click","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"]],template:function(e,n){if(e&1){let a=T();t(0,"p-fluid")(1,"div",2)(2,"div",3)(3,"div",4),o(4),i(),t(5,"div",5)(6,"div",6)(7,"label",7),o(8,"Titular:"),i(),t(9,"input",8),_("ngModelChange",function(s){return p(a),g(n.proveedor,s)||(n.proveedor=s),m(s)}),i()(),t(10,"div",6)(11,"label",9),o(12,"Transportista"),i(),t(13,"input",10),_("ngModelChange",function(s){return p(a),g(n.transportista,s)||(n.transportista=s),m(s)}),i()()()()(),t(14,"div",11)(15,"div",3)(16,"div",4),o(17,"Registrar Evaluaciones"),i(),t(18,"div",5)(19,"div",6)(20,"label",12),o(21,"Criterio de Evaluacion"),i(),t(22,"p-select",13),_("ngModelChange",function(s){return p(a),g(n.criterio_calidad.values,s)||(n.criterio_calidad.values=s),m(s)})("ngModelChange",function(s){return p(a),g(n.selectedValue,s)||(n.selectedValue=s),m(s)}),S("ngModelChange",function(){return p(a),m(n.seleccionar())}),i()(),t(23,"div",6)(24,"label",14),o(25,"Valor"),i(),t(26,"input",15),_("ngModelChange",function(s){return p(a),g(n.valor,s)||(n.valor=s),m(s)}),i()(),t(27,"div",6)(28,"label",14),o(29,"Factor o Peso Prom"),i(),t(30,"input",16),_("ngModelChange",function(s){return p(a),g(n.factor_castigo,s)||(n.factor_castigo=s),m(s)}),i()()(),t(31,"div",5)(32,"p-button",17),S("onClick",function(){return p(a),m(n.validarFormulario())}),i()(),t(33,"div",18)(34,"p-table",19),M(35,_i,13,0,"ng-template",null,0,C)(37,vi,15,9,"ng-template",null,1,C),i()()()(),t(39,"div",11)(40,"div",3)(41,"div",4),o(42,"Registrar Informacion adicional"),i(),t(43,"div",5)(44,"div",6)(45,"label",14),o(46,"Campa\xF1a"),i(),t(47,"input",20),_("ngModelChange",function(s){return p(a),g(n.campana,s)||(n.campana=s),m(s)}),i()(),t(48,"div",6)(49,"label",12),o(50,"Tipo Racimo"),i(),t(51,"p-select",21),_("ngModelChange",function(s){return p(a),g(n.racimoSeleccionado,s)||(n.racimoSeleccionado=s),m(s)}),i()(),t(52,"div",6)(53,"label",12),o(54,"Condicion del Vehiculo"),i(),t(55,"p-select",22),_("ngModelChange",function(s){return p(a),g(n.limpiezaSeleccionado,s)||(n.limpiezaSeleccionado=s),m(s)}),i()()(),t(56,"div",5)(57,"p-button",23),S("click",function(){return p(a),m(n.saveControlRff())}),i(),w(58,"p-button",24),i()()()(),t(59,"p-dialog",25),_("visibleChange",function(s){return p(a),g(n.mostrarErrores,s)||(n.mostrarErrores=s),m(s)}),t(60,"p"),o(61,"Se ha producido las siguientes inconsistencias:"),i(),t(62,"ul",26),M(63,Si,2,1,"li",27),i()(),w(64,"p-confirmDialog")(65,"p-toast",28)}e&2&&(d(4),N("Evaluacion ticket: ",n.numTicket," - Datos Generales"),d(5),h("ngModel",n.proveedor),u("disabled",!0),d(4),h("ngModel",n.transportista),u("disabled",!0),d(9),h("ngModel",n.criterio_calidad.values)("ngModel",n.selectedValue),u("options",n.criterio_calidad),d(4),h("ngModel",n.valor),d(4),h("ngModel",n.factor_castigo),u("disabled",!0),d(2),u("fluid",!1),d(2),u("value",n.evaluacion_calidad)("tableStyle",O(29,gi)),d(13),h("ngModel",n.campana),d(4),h("ngModel",n.racimoSeleccionado),u("options",n.tipoRacimo),d(4),h("ngModel",n.limpiezaSeleccionado),u("options",n.limpieza),d(2),u("fluid",!1),d(),u("fluid",!1),d(),be(O(30,fi)),h("visible",n.mostrarErrores),u("modal",!0)("closable",!0)("contentStyle",O(31,hi))("baseZIndex",1e4),d(4),u("ngForOf",n.errores))},dependencies:[F,G,j,H,ee,$,St,z,bt,q,te,Y,ue,De,xt,A,de],encapsulation:2})};var qe=class l extends R{constructor(e){super(e,`${D.HOST}/personas`);this.http=e}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var xi=()=>({standalone:!0}),yi=l=>["/pages/registrar-evaluacion",l];function Ci(l,r){if(l&1&&o(0),l&2){let e=r.$implicit;lt(" ",e==null?null:e.paterno," ",e==null?null:e.materno," ",e==null?null:e.nombres," ")}}function wi(l,r){if(l&1&&o(0),l&2){let e=r.$implicit;lt(" ",e==null?null:e.paterno," ",e==null?null:e.materno," ",e==null?null:e.nombres," ")}}function Ei(l,r){if(l&1&&(t(0,"li"),o(1),i()),l&2){let e=r.$implicit;d(),f(e)}}function Mi(l,r){if(l&1&&(t(0,"div",21)(1,"p",22),o(2,"Se han producido las siguientes inconsistencias:"),i(),t(3,"ul",23),M(4,Ei,2,1,"li",24),i()()),l&2){let e=v();d(4),u("ngForOf",e.errores)}}function Ti(l,r){l&1&&(t(0,"tr")(1,"th",25),o(2,"Ticket"),i(),t(3,"th",25),o(4,"Fecha"),i(),t(5,"th",25),o(6,"Peso"),i(),t(7,"th",26),o(8,"Transportista"),i(),t(9,"th",25),o(10,"Vehiculo"),i(),t(11,"th",25),o(12,"Editar"),i(),t(13,"th",25),o(14,"Evaluado"),i()())}function Pi(l,r){if(l&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),w(12,"p-button",27),i(),t(13,"td"),w(14,"p-button",28),i()()),l&2){let e=r.$implicit;d(2),N(" ",e.numTicket," "),d(2),f(e.fecha),d(2),f(e.pesoNeto),d(2),f(e.transportista),d(2),f(e.placa),d(2),u("rounded",!0)("text",!0)("routerLink",se(10,yi,e.idPesaje)),d(2),u("rounded",!0)("text",!0)}}function Vi(l,r){l&1&&(t(0,"tr")(1,"td",29),o(2,"Sin Datos"),i()())}var Ke=class l{constructor(r,e){this.personaService=r;this.pesoDestare=e}meses=[{name:"ENERO",value:"01"},{name:"FEBRERO",value:"02"},{name:"MARZO",value:"03"},{name:"ABRIL",value:"04"},{name:"MAYO",value:"05"},{name:"JUNIO",value:"06"},{name:"JULIO",value:"07"},{name:"AGOSTO",value:"08"},{name:"SETIEMBRE",value:"09"},{name:"OCTUBRE",value:"10"},{name:"NOVIEMBRE",value:"11"},{name:"DICIEMBRE",value:"12"}];persona;selectedAutoValue=null;autoFilteredValue=[];mesSeleccionado;anio;proveedor;errores=[];errorMessage="";mostrarErrores=!1;carga;ngOnInit(){this.personaService.findAll().subscribe(r=>{this.persona=r.map(e=>{let n=[e?.paterno,e?.materno,e?.nombres].filter(Boolean).map(a=>a.trim());return ft(Ce({},e),{nombreCompleto:n.join(" ")})})})}filtrarProveedores(r){let e=r.query?.toLowerCase()??"";if(e.length<4){this.autoFilteredValue=[];return}let n=this.persona.filter(a=>`${a?.paterno??""} ${a?.materno??""} ${a?.nombres??""}`.toLowerCase().includes(e));this.autoFilteredValue=n}shoeProveedor(r){return r&&r.nombreCompleto}buscar(){this.pesoDestare.searchByProveedorAnioMes(this.selectedAutoValue.codigo,this.anio,this.mesSeleccionado.value).subscribe(r=>{this.carga=r,console.log(this.carga),this.proveedor=this.carga[0].proveedor})}validarFormulario(){this.errores=[],this.selectedAutoValue||this.errores.push("No se ha seleccionado el titular."),(!this.anio||this.anio<=0)&&this.errores.push("No se ha ingresado el a\xF1o."),this.mesSeleccionado||this.errores.push("No se ha seleccionado el mes de consulta."),!(this.errores.length>0)&&this.buscar()}static \u0275fac=function(e){return new(e||l)(b(qe),b(U))};static \u0275cmp=k({type:l,selectors:[["app-consult-proveedor"]],decls:33,vars:15,consts:[["header",""],["body",""],["emptymessage",""],[1,"flex"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],[1,"grid","grid-cols-12","gap-4","grid-cols-12","gap-2"],["for","name3",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],[1,"col-span-12","md:col-span-5"],["placeholder","Buscar proveedor...","display","chip","optionLabel","nombreCompleto",3,"ngModelChange","completeMethod","ngModel","suggestions","forceSelection","dropdown","ngModelOptions"],["pTemplate","item"],["pTemplate","selectedItem"],["for","email3",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],[1,"col-span-12","md:col-span-2"],["pInputText","","id","email3","type","text",3,"ngModelChange","ngModel"],["optionLabel","name","id","state","placeholder","Seeleccionar",1,"w-full",3,"ngModelChange","ngModel","options"],["label","Buscar","icon","pi pi-check",3,"onClick","fluid"],["class","bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4 text-center",4,"ngIf"],[1,"card","mt-3"],[1,"text-xl","mb-2"],["emptyMessage","Sin datos",3,"value","rows","paginator"],[1,"bg-red-100","border","border-red-400","text-red-700","px-4","py-3","rounded","mb-4","text-center"],[1,"font-bold","mb-2"],[1,"list-disc","list-inside","text-left","inline-block"],[4,"ngFor","ngForOf"],["pFrozenColumn","",1,"font-bold",2,"min-width","50px"],["pFrozenColumn","",1,"font-bold",2,"min-width","150px"],["icon","pi pi-file-edit","severity","info","routerLinkActive","router-link-active",3,"rounded","text","routerLink"],["icon","pi pi-check-circle","severity","info",3,"rounded","text"],["colspan","8"]],template:function(e,n){if(e&1){let a=T();t(0,"p-fluid")(1,"div",3)(2,"div",4)(3,"div",5),o(4,"Consulta de Pesos y Evaluaciones de calidad"),i(),t(5,"div",6)(6,"label",7),o(7,"Nombre:"),i(),t(8,"div",8)(9,"p-autoComplete",9),_("ngModelChange",function(s){return p(a),g(n.selectedAutoValue,s)||(n.selectedAutoValue=s),m(s)}),S("completeMethod",function(s){return p(a),m(n.filtrarProveedores(s))}),M(10,Ci,1,3,"ng-template",10)(11,wi,1,3,"ng-template",11),i()()(),t(12,"div",6)(13,"label",12),o(14,"A\xF1o"),i(),t(15,"div",13)(16,"input",14),_("ngModelChange",function(s){return p(a),g(n.anio,s)||(n.anio=s),m(s)}),i()(),t(17,"label",12),o(18,"Mes"),i(),t(19,"div",13)(20,"p-select",15),_("ngModelChange",function(s){return p(a),g(n.mesSeleccionado,s)||(n.mesSeleccionado=s),m(s)}),i()(),t(21,"p-button",16),S("onClick",function(){return p(a),m(n.validarFormulario())}),i()(),M(22,Mi,5,1,"div",17),i()(),t(23,"div",18)(24,"div",19),o(25),i(),t(26,"p-table",20),M(27,Ti,15,0,"ng-template",null,0,C)(29,Pi,15,12,"ng-template",null,1,C)(31,Vi,3,0,"ng-template",null,2,C),i()()()}e&2&&(d(9),h("ngModel",n.selectedAutoValue),u("suggestions",n.autoFilteredValue)("forceSelection",!1)("dropdown",!0)("ngModelOptions",O(14,xi)),d(7),h("ngModel",n.anio),d(4),h("ngModel",n.mesSeleccionado),u("options",n.meses),d(),u("fluid",!1),d(),u("ngIf",n.errores.length>0),d(3),N(" Proveedor: ",n.proveedor," "),d(),u("value",n.carga)("rows",10)("paginator",!0))},dependencies:[F,G,vt,me,j,H,ee,$,z,q,te,Mt,K,A,de,ce],encapsulation:2})};var Ii=l=>["/pages/registrar-evaluacion",l];function Di(l,r){l&1&&(t(0,"tr")(1,"th",14),o(2,"Ticket"),i(),t(3,"th",15),o(4,"Fecha"),i(),t(5,"th",16),o(6,"Titular"),i(),t(7,"th",14),o(8,"Peso"),i(),t(9,"th",16),o(10,"Transportista"),i(),t(11,"th",17),o(12,"Vehiculo"),i(),t(13,"th",14),o(14,"Editar"),i(),t(15,"th",14),o(16,"Evaluado"),i()())}function ki(l,r){if(l&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),w(14,"p-button",18),i(),t(15,"td"),w(16,"p-button",19),i()()),l&2){let e=r.$implicit;d(2),N(" ",e.numTicket),d(2),N(" ",e.fecha),d(2),N(" ",e.proveedor),d(2),N(" ",e.pesoNeto),d(2),N(" ",e.transportista),d(2),N(" ",e.placa),d(2),u("routerLink",se(11,Ii,e.idPesaje))("rounded",!0)("text",!0),d(2),u("rounded",!0)("text",!0)}}function Fi(l,r){l&1&&(t(0,"tr")(1,"td",20),o(2,"Sin Datos"),i()())}var Xe=class l{constructor(r,e){this.pesoDestareService=r;this.service=e}calendarValue=new Date;message;pesoDestare;ngOnInit(){}buscarPesajes(){if(!this.calendarValue){this.service.add({severity:"error",summary:"Error",detail:"Debe seleccionar una fecha v\xE1lida.",life:6e3});return}let r=re(this.calendarValue,"yyyy-MM-dd","en-US");this.pesoDestareService.searchByDate(r).subscribe(e=>{e&&e.length>0?this.pesoDestare=e:(this.service.add({severity:"warn",summary:"Sin resultados",detail:"No se encontraron datos para la fecha seleccionada.",life:5e3}),this.pesoDestare=e)},e=>{this.service.add({severity:"error",summary:"Error de conexi\xF3n",detail:"Ocurri\xF3 un error al consultar los datos.",life:5e3}),console.error("Error al consultar peso destare:",e)})}checkDate(){this.calendarValue||(this.calendarValue=new Date)}static \u0275fac=function(e){return new(e||l)(b(U),b(X))};static \u0275cmp=k({type:l,selectors:[["app-consult-fecha"]],decls:20,vars:8,consts:[["header",""],["body",""],["emptymessage",""],[1,"flex"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],[1,"grid","grid-cols-12","gap-4","grid-cols-12","gap-2"],["for","email3",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],[1,"col-span-12","md:col-span-2"],[3,"ngModelChange","onBlur","ngModel","dateFormat","showIcon","readonlyInput"],["label","Buscar","icon","pi pi-check",3,"onClick","fluid"],[1,"card","mt-3"],["emptyMessage","Sin datos",3,"value","rows","paginator"],["position","top-right"],["pFrozenColumn","",1,"font-bold",2,"min-width","50px"],["pFrozenColumn","",1,"font-bold",2,"min-width","120px"],["pFrozenColumn","",1,"font-bold",2,"min-width","200px"],["pFrozenColumn","",1,"font-bold",2,"min-width","100px"],["icon","pi pi-file-edit","routerLinkActive","router-link-active","severity","info",3,"routerLink","rounded","text"],["icon","pi pi-check-circle","severity","info",3,"rounded","text"],["colspan","8"]],template:function(e,n){if(e&1){let a=T();t(0,"p-fluid")(1,"div",3)(2,"div",4)(3,"div",5),o(4,"Consulta de Pesos y Evaluaciones de calidad"),i(),t(5,"div",6)(6,"label",7),o(7,"Fecha:"),i(),t(8,"div",8)(9,"p-datepicker",9),_("ngModelChange",function(s){return p(a),g(n.calendarValue,s)||(n.calendarValue=s),m(s)}),S("onBlur",function(){return p(a),m(n.checkDate())}),i()(),t(10,"p-button",10),S("onClick",function(){return p(a),m(n.buscarPesajes())}),i()()()(),t(11,"div",11)(12,"p-table",12),M(13,Di,17,0,"ng-template",null,0,C)(15,ki,17,13,"ng-template",null,1,C)(17,Fi,3,0,"ng-template",null,2,C),i()()(),w(19,"p-toast",13)}e&2&&(d(9),h("ngModel",n.calendarValue),u("dateFormat","dd/mm/yy")("showIcon",!0)("readonlyInput",!0),d(),u("fluid",!1),d(2),u("value",n.pesoDestare)("rows",10)("paginator",!0))},dependencies:[F,G,me,j,H,z,q,Y,pe,K],encapsulation:2})};var Ye=class{id_peso_medida;estado;num_registro;peso_bruto_transp;peso_max_perm;fecha;usuario;id_guia;id_pesaje;id_vehiculo;id_vehiculo2};var Je=class{id_guia;fecha_emision;serie;numero;fecha_inicio;partida;destino;motivo_traslado;estado;observacion;codigo_destinatario;num_doc_destinatario;version;usuario;presintos;codigo_et;codigo_cond;id_vehiculo;pedido};var Ze=class l extends R{constructor(e){super(e,`${D.HOST}/guia_remision`);this.http=e}listarTicketsPorEstado(){return this.http.get(`${this.url}/facturado`)}searchGuiaPorSerieNumero(e,n,a){return this.http.get(`${this.url}/buscar/${e}/${n}/${a}`)}searchByDate(e){return this.http.get(`${this.url}/search/date?date=${e}`)}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var ne=class l extends R{constructor(e){super(e,`${D.HOST}/peso_medidas`);this.http=e}searchByDate(e){return this.http.get(`${this.url}/search/date?date=${e}`)}guardar(e){return this.http.post(this.url,e,{observe:"response"})}anularPesoMedida(e){let n=`${this.url}/${e}/anular`;return this.http.put(n,{})}generatePdf(e){return this.http.get(`${this.url}/pdf/${e}`,{responseType:"arraybuffer"})}existsByIdGuia(e){return this.http.get(`${this.url}/existe/${e}`)}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};function Wi(l,r){if(l&1){let e=T();Ee(0),t(1,"div",45)(2,"label",54),o(3,"Serie:"),i(),t(4,"p-select",55),_("ngModelChange",function(a){p(e);let c=v();return g(c.serieSeleccionado,a)||(c.serieSeleccionado=a),m(a)}),i()(),t(5,"div",45)(6,"label",56),o(7,"N\xFAmero:"),i(),t(8,"input",57),_("ngModelChange",function(a){p(e);let c=v();return g(c.numero_buscar,a)||(c.numero_buscar=a),m(a)}),i()(),t(9,"div",58)(10,"p-button",59),S("onClick",function(){p(e);let a=v();return m(a.buscarGuiaRemision())}),i()(),Me()}if(l&2){let e=v();d(4),h("ngModel",e.serieSeleccionado),u("options",e.serie),d(4),h("ngModel",e.numero_buscar)}}function ji(l,r){l&1&&(t(0,"tr")(1,"th"),o(2,"Codigo"),i(),t(3,"th"),o(4,"Fecha"),i(),t(5,"th"),o(6,"Serie"),i(),t(7,"th"),o(8,"Numero"),i(),t(9,"th"),o(10,"Cliente"),i(),t(11,"th"),o(12,"Documento"),i(),t(13,"th"),o(14,"Cantidad"),i(),t(15,"th"),o(16,"UM"),i(),t(17,"th"),o(18,"Descripcion"),i(),t(19,"th"),o(20,"Estado"),i()())}function Ai(l,r){if(l&1){let e=T();t(0,"tr",60),S("dblclick",function(){p(e);let a=v();return m(a.seleccionarGuia())}),t(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),o(14),i(),t(15,"td"),o(16),i(),t(17,"td"),o(18),i(),t(19,"td"),o(20),i()()}if(l&2){let e=r.$implicit,n=v();u("pSelectableRow",e),d(2),f(e.idGuia),d(2),f(e.fechaEmision),d(2),f(e.serie),d(2),f(e.numero),d(2),f(e.cliente),d(2),f(e.numDocDestinatario),d(2),f(n.convertirAToneladas(e.pesoNeto)),d(2),f(e.unidadMedida),d(2),f(e.descripcion),d(2),f(e.estado)}}function Bi(l,r){l&1&&(t(0,"tr")(1,"td",61),o(2,"No se encontraron comprobantes"),i()())}var Qe=class l{constructor(r,e,n,a,c,s){this.pesoDestareService=r;this.guiaRemisionService=e;this.pesoMedidaService=n;this.vehiculoService=a;this.router=c;this.service=s}displayModal=!1;displayModal2=!1;pesoDestare;numTicket;ticketSeleccionado={};ticketTemporal={};estadoSeleccionado="No Facturado";serieSeleccionado;guia_remision=[];estado;serie;numero_guia;serie_guia;id_guia;empresa_transporte;conductor;placas;descripcion;num_ticket;cliente;peso_ingreso;peso_salida;peso_neto;id_pesaje;id_vehiculo;peso_max_perm;id_vehiculo2;numero_buscar;guiaTemporal;guiaSeleccionada;guiaSeleccionadaFinal=null;serie_numero;calendarValue=new Date;nuevoId;fechaActual;vehiculo;placa1;placa2;ngOnInit(){this.fechaActual=this.obtenerFechaActual(),console.log("fecha Hoy: "+this.fechaActual),this.estado=[{label:"Guias de Hoy",value:"Guias de Hoy"},{label:"Facturado",value:"Facturado"}],this.serie=[{label:"TTT1",value:"TTT1"},{label:"TTT2",value:"TTT2"}]}obtenerFechaActual(){return re(new Date,"yyyy-MM-dd","en-US")}abrirModal2(){this.displayModal2=!0,this.estadoSeleccionado="Guias de Hoy",this.guiaRemisionService.searchByDate(this.fechaActual).subscribe(r=>{this.guia_remision=r}),this.serieSeleccionado=null,this.numero_buscar=null}manejarCambioEstado(){this.ticketTemporal=null,this.estadoSeleccionado==="Facturado"?(this.guia_remision=[],this.numTicket=""):this.guiaRemisionService.searchByDate(this.fechaActual).subscribe({next:r=>{this.guia_remision=r},error:r=>{console.error("Error al cargar gu\xEDas de remisi\xF3n:",r)}})}seleccionarGuia(){this.ticketTemporal&&this.ticketTemporal.idGuia?(this.guiaSeleccionadaFinal=this.ticketTemporal,this.displayModal2=!1,this.ticketTemporal=null,this.id_guia=this.guiaSeleccionadaFinal.idGuia,this.id_pesaje=this.guiaSeleccionadaFinal.idPesaje,this.serie_numero=`${this.guiaSeleccionadaFinal.serie}-${this.guiaSeleccionadaFinal.numero}`,this.serie_guia=this.guiaSeleccionadaFinal.serie,this.numero_guia=this.guiaSeleccionadaFinal.numero,this.empresa_transporte=this.guiaSeleccionadaFinal.transportista,this.conductor=this.guiaSeleccionadaFinal.conductores,this.id_vehiculo=this.guiaSeleccionadaFinal.idVehiculoPrincipal,this.id_vehiculo2=this.guiaSeleccionadaFinal.idVehiculoSecundario,this.placas=this.guiaSeleccionadaFinal.placaSecundario?`${this.guiaSeleccionadaFinal.placaPrincipal}/${this.guiaSeleccionadaFinal.placaSecundario}`:this.guiaSeleccionadaFinal.placaPrincipal,this.placa1=this.guiaSeleccionadaFinal.placaPrincipal,this.placa2=this.guiaSeleccionadaFinal.placaSecundario,this.num_ticket=this.guiaSeleccionadaFinal.numTicket,this.descripcion=this.guiaSeleccionadaFinal.descripcion,this.cliente=this.guiaSeleccionadaFinal.cliente,this.peso_ingreso=this.guiaSeleccionadaFinal.pesoIngreso,this.peso_salida=this.guiaSeleccionadaFinal.pesoSalida,this.peso_neto=this.guiaSeleccionadaFinal.pesoNeto,this.peso_max_perm=this.guiaSeleccionadaFinal.pesoMaxPermitido):this.service.add({severity:"warn",summary:"Selecci\xF3n requerida",detail:"Debe seleccionar una fila antes de continuar."})}buscarGuiaRemision(){this.guiaRemisionService.searchGuiaPorSerieNumero("SI",this.serieSeleccionado,this.numero_buscar).subscribe(r=>{this.guia_remision=r})}checkDate(){this.calendarValue||(this.calendarValue=new Date)}operarPesosMedidas(){debugger;let r=re(this.calendarValue,"yyyy-MM-dd","en-US"),e=new ae;e.id_pesaje=this.id_pesaje;let n=new Je;n.id_guia=this.id_guia;let a=new oe;a.id_vehiculo=this.id_vehiculo,a.peso_max_permitido=this.peso_max_perm;let c=null;this.placa2&&(c=new oe,c.id_vehiculo=this.id_vehiculo2);let s=new Ye;s.estado="EMITIDO",s.fecha=r,s.num_registro=this.num_ticket,s.peso_bruto_transp=this.peso_salida,s.id_vehiculo=a,s.peso_max_perm=a.peso_max_permitido,s.id_vehiculo2=c,s.peso_bruto_transp=this.convertirAToneladas(this.peso_salida),s.usuario="VEUSEBIO",s.id_guia=n,s.id_pesaje=e,this.pesoMedidaService.existsByIdGuia(this.id_guia).subscribe(x=>{x?this.service.add({severity:"error",summary:"Error",detail:"Ya existe un peso medida asociado a esta gu\xEDa de remisi\xF3n."}):this.pesoMedidaService.guardar(s).subscribe(y=>{let B=y.headers.get("Location");B?(this.nuevoId=Number(B.split("/").pop()),console.log("Nuevo ID:",this.nuevoId),this.router.navigate(["/pages/resultado",this.nuevoId])):console.warn("No se recibi\xF3 la cabecera Location")})}),console.log(s,this.peso_salida),s.peso_bruto_transp=this.convertirAToneladas(this.peso_salida)}convertirAToneladas(r){return r/1e3}static \u0275fac=function(e){return new(e||l)(b(U),b(Ze),b(ne),b(ge),b(Pe),b(X))};static \u0275cmp=k({type:l,selectors:[["app-pesomedida"]],decls:88,vars:53,consts:[["header",""],["body",""],["emptymessage",""],[1,"flex"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],["header","Buscar Guia:",3,"toggleable"],[1,"grid","grid-cols-12","gap-4","grid-cols-12"],["for","email3",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],[1,"col-span-12","md:col-span-2","flex","items-center","gap-2"],["pInputText","","type","text","placeholder","TTT1-002589",3,"ngModelChange","disabled","ngModel"],["icon","pi pi-search","styleClass","p-button-warning p-button-sm p-button-icon-only",3,"onClick"],["for","email3",1,"flex","items-center","col-span-12","mb-2","md:col-span-1","md:mb-0"],[1,"col-span-12","md:col-span-3","flex","items-center","gap-2"],[3,"ngModelChange","onBlur","ngModel","dateFormat","showIcon","readonlyInput"],["legend","Datos de la Gu\xEDa",3,"toggleable"],[1,"grid","grid-cols-12","gap-4"],[1,"col-span-12","md:col-span-1","flex","flex-col","gap-2"],["for","serie",1,"font-medium","text-gray-700"],["pInputText","","id","serie","type","text",1,"p-inputtext-sm","w-full",3,"ngModelChange","ngModel","disabled"],["pInputText","","id","id_guia","type","text",1,"p-inputtext-sm","w-full",3,"ngModelChange","ngModel","hidden"],["for","numero",1,"font-medium","text-gray-700"],["pInputText","","id","numero","type","text",1,"p-inputtext-sm","w-full",3,"ngModelChange","ngModel","disabled"],[1,"col-span-12","md:col-span-4","flex","flex-col","gap-2"],["for","empresa",1,"font-medium","text-gray-700"],["pInputText","","id","empresa","type","text",1,"p-inputtext-sm","w-full",3,"ngModelChange","ngModel","disabled"],["for","conductor",1,"font-medium","text-gray-700"],["pInputText","","id","conductor","type","text",1,"p-inputtext-sm","w-full",3,"ngModelChange","ngModel","disabled"],[1,"col-span-12","md:col-span-2","flex","flex-col","gap-2"],["for","placas",1,"font-medium","text-gray-700"],["pInputText","","id","placas","type","text",1,"p-inputtext-sm","w-full",3,"ngModelChange","ngModel","disabled"],["pInputText","","id","id_vehiculo","type","text",1,"p-inputtext-sm","w-full",3,"ngModelChange","ngModel","hidden"],["pInputText","","id","id_vehiculo2","type","text",1,"p-inputtext-sm","w-full",3,"ngModelChange","ngModel","hidden"],["legend","Datos del Ticket",3,"toggleable"],["pInputText","","id","id_pesaje","type","text",1,"p-inputtext-sm","w-full",3,"ngModelChange","ngModel","hidden"],[1,"col-span-12","md:col-span-3","flex","flex-col","gap-2"],["for","pesoIngreso",1,"font-medium","text-gray-700"],["pInputText","","id","pesoIngreso","type","text",1,"p-inputtext-sm","w-full",3,"ngModelChange","ngModel","disabled"],["for","pesoSalida",1,"font-medium","text-gray-700"],["pInputText","","id","pesoSalida","type","text",1,"p-inputtext-sm","w-full",3,"ngModelChange","ngModel","disabled"],["for","pesoNeto",1,"font-medium","text-gray-700"],["pInputText","","id","pesoNeto","type","text",1,"p-inputtext-sm","w-full",3,"ngModelChange","ngModel","disabled"],["label","Guardar","icon","pi pi-check",3,"onClick","fluid"],["header","Gu\xEDa de remisi\xF3n pendientes de facturar",3,"visibleChange","visible","modal","closable","styleClass"],[1,"flex","flex-col","md:flex-row","gap-6","w-full"],[1,"flex","flex-col","w-full","md:w-1/3"],["for","state"],["id","state","optionValue","value","optionLabel","label",3,"ngModelChange","onChange","ngModel","options"],[4,"ngIf"],[1,"overflow-x-auto","mt-4"],["selectionMode","single","dataKey","idGuia","currentPageReportTemplate","Mostrando {first} to {last} de {totalRecords} vehiculos",3,"selectionChange","value","showCurrentPageReport","rows","rowHover","paginator","selection"],[1,"flex","flex-col","md:flex-row","gap-6","mt-4"],["icon","pi pi-check","label","Seleccionar",1,"w-full","md:w-auto",3,"onClick"],["position","top-right"],["for","serie"],["id","serie","placeholder","Seleccionar","optionLabel","label","optionValue","value",3,"ngModelChange","ngModel","options"],["for","numTicket"],["pInputText","","id","numTicket","type","text","placeholder","N\xFAmero",3,"ngModelChange","ngModel"],[1,"flex","w-full","mt-4"],["icon","pi pi-search","label","Buscar",1,"w-full","md:w-auto",3,"onClick"],[3,"dblclick","pSelectableRow"],["colspan","10"]],template:function(e,n){if(e&1){let a=T();t(0,"p-fluid")(1,"div",3)(2,"div",4)(3,"div",5),o(4,"Registrar Pesos y Medidas"),i(),t(5,"p-panel",6)(6,"div",7)(7,"label",8),o(8," Gu\xEDa de Remisi\xF3n: "),i(),t(9,"div",9)(10,"input",10),_("ngModelChange",function(s){return p(a),g(n.serie_numero,s)||(n.serie_numero=s),m(s)}),i(),t(11,"p-button",11),S("onClick",function(){return p(a),m(n.abrirModal2())}),i()(),t(12,"label",12),o(13,"Fecha: "),i(),t(14,"div",13)(15,"p-datepicker",14),_("ngModelChange",function(s){return p(a),g(n.calendarValue,s)||(n.calendarValue=s),m(s)}),S("onBlur",function(){return p(a),m(n.checkDate())}),i()()()(),t(16,"p-fieldset",15)(17,"div",16)(18,"div",17)(19,"label",18),o(20,"Serie:"),i(),t(21,"input",19),_("ngModelChange",function(s){return p(a),g(n.serie_guia,s)||(n.serie_guia=s),m(s)}),i(),t(22,"input",20),_("ngModelChange",function(s){return p(a),g(n.id_guia,s)||(n.id_guia=s),m(s)}),i()(),t(23,"div",17)(24,"label",21),o(25,"N\xFAmero:"),i(),t(26,"input",22),_("ngModelChange",function(s){return p(a),g(n.numero_guia,s)||(n.numero_guia=s),m(s)}),i()(),t(27,"div",23)(28,"label",24),o(29,"Empresa Transporte:"),i(),t(30,"input",25),_("ngModelChange",function(s){return p(a),g(n.empresa_transporte,s)||(n.empresa_transporte=s),m(s)}),i()(),t(31,"div",23)(32,"label",26),o(33,"Conductor:"),i(),t(34,"input",27),_("ngModelChange",function(s){return p(a),g(n.conductor,s)||(n.conductor=s),m(s)}),i()(),t(35,"div",28)(36,"label",29),o(37,"Placas:"),i(),t(38,"input",30),_("ngModelChange",function(s){return p(a),g(n.placas,s)||(n.placas=s),m(s)}),i(),t(39,"input",31),_("ngModelChange",function(s){return p(a),g(n.id_vehiculo,s)||(n.id_vehiculo=s),m(s)}),i(),t(40,"input",32),_("ngModelChange",function(s){return p(a),g(n.id_vehiculo2,s)||(n.id_vehiculo2=s),m(s)}),i()()()(),t(41,"p-fieldset",33)(42,"div",16)(43,"div",28)(44,"label",18),o(45,"Num Ticket:"),i(),t(46,"input",19),_("ngModelChange",function(s){return p(a),g(n.num_ticket,s)||(n.num_ticket=s),m(s)}),i(),t(47,"input",34),_("ngModelChange",function(s){return p(a),g(n.id_pesaje,s)||(n.id_pesaje=s),m(s)}),i()(),t(48,"div",35)(49,"label",21),o(50,"Producto:"),i(),t(51,"input",22),_("ngModelChange",function(s){return p(a),g(n.descripcion,s)||(n.descripcion=s),m(s)}),i()(),t(52,"div",35)(53,"label",24),o(54,"Cliente:"),i(),t(55,"input",25),_("ngModelChange",function(s){return p(a),g(n.cliente,s)||(n.cliente=s),m(s)}),i()(),t(56,"div",17)(57,"label",36),o(58,"Peso Ingreso:"),i(),t(59,"input",37),_("ngModelChange",function(s){return p(a),g(n.peso_ingreso,s)||(n.peso_ingreso=s),m(s)}),i()(),t(60,"div",17)(61,"label",38),o(62,"Peso Salida:"),i(),t(63,"input",39),_("ngModelChange",function(s){return p(a),g(n.peso_salida,s)||(n.peso_salida=s),m(s)}),i()(),t(64,"div",17)(65,"label",40),o(66,"Peso Neto:"),i(),t(67,"input",41),_("ngModelChange",function(s){return p(a),g(n.peso_neto,s)||(n.peso_neto=s),m(s)}),i()()()(),t(68,"p-button",42),S("onClick",function(){return p(a),m(n.operarPesosMedidas())}),i()()()(),t(69,"p-dialog",43),_("visibleChange",function(s){return p(a),g(n.displayModal2,s)||(n.displayModal2=s),m(s)}),t(70,"p-fluid")(71,"div",44)(72,"div",45)(73,"label",46),o(74,"Estado:"),i(),t(75,"p-select",47),_("ngModelChange",function(s){return p(a),g(n.estadoSeleccionado,s)||(n.estadoSeleccionado=s),m(s)}),S("onChange",function(){return p(a),m(n.manejarCambioEstado())}),i()(),M(76,Wi,11,3,"ng-container",48),i(),t(77,"div",49)(78,"p-table",50),_("selectionChange",function(s){return p(a),g(n.ticketTemporal,s)||(n.ticketTemporal=s),m(s)}),M(79,ji,21,0,"ng-template",null,0,C)(81,Ai,21,11,"ng-template",null,1,C)(83,Bi,3,0,"ng-template",null,2,C),i()(),t(85,"div",51)(86,"p-button",52),S("onClick",function(){return p(a),m(n.seleccionarGuia())}),i()()()(),w(87,"p-toast",53)}e&2&&(d(5),u("toggleable",!1),d(5),u("disabled",!0),h("ngModel",n.serie_numero),d(5),h("ngModel",n.calendarValue),u("dateFormat","dd/mm/yy")("showIcon",!0)("readonlyInput",!0),d(),u("toggleable",!1),d(5),h("ngModel",n.serie_guia),u("disabled",!0),d(),h("ngModel",n.id_guia),u("hidden",!0),d(4),h("ngModel",n.numero_guia),u("disabled",!0),d(4),h("ngModel",n.empresa_transporte),u("disabled",!0),d(4),h("ngModel",n.conductor),u("disabled",!0),d(4),h("ngModel",n.placas),u("disabled",!0),d(),h("ngModel",n.id_vehiculo),u("hidden",!0),d(),h("ngModel",n.id_vehiculo2),u("hidden",!0),d(),u("toggleable",!1),d(5),h("ngModel",n.num_ticket),u("disabled",!0),d(),h("ngModel",n.id_pesaje),u("hidden",!0),d(4),h("ngModel",n.descripcion),u("disabled",!0),d(4),h("ngModel",n.cliente),u("disabled",!0),d(4),h("ngModel",n.peso_ingreso),u("disabled",!0),d(4),h("ngModel",n.peso_salida),u("disabled",!0),d(4),h("ngModel",n.peso_neto),u("disabled",!0),d(),u("fluid",!1),d(),h("visible",n.displayModal2),u("modal",!0)("closable",!0)("styleClass","w-full md:w-3/4 lg:w-2/3"),d(6),h("ngModel",n.estadoSeleccionado),u("options",n.estado),d(),u("ngIf",n.estadoSeleccionado==="Facturado"),d(2),u("value",n.guia_remision)("showCurrentPageReport",!0)("rows",5)("rowHover",!0)("paginator",!0),h("selection",n.ticketTemporal))},dependencies:[F,G,Ie,j,H,ee,$,z,q,te,Y,pe,Tt,ue,Dt,A,ce],encapsulation:2})};var Lt=Ht(Bt());function Li(l,r){l&1&&(t(0,"tr")(1,"th",14),o(2,"Codigo"),i(),t(3,"th",15),o(4,"Fecha"),i(),t(5,"th",16),o(6,"Cliente"),i(),t(7,"th",16),o(8,"Transportista"),i(),t(9,"th",17),o(10,"Placa"),i(),t(11,"th",14),o(12,"Guia Remision"),i(),t(13,"th",14),o(14,"Peso Permitido(TN)"),i(),t(15,"th",14),o(16,"Peso Transportado(TN)"),i(),t(17,"th",14),o(18,"Descargar PDF"),i(),t(19,"th",14),o(20,"Estado"),i(),t(21,"th",14),o(22,"Acciones"),i()())}function Oi(l,r){if(l&1){let e=T();t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),o(14),i(),t(15,"td"),o(16),i(),t(17,"td")(18,"p-button",18),S("onClick",function(){let a=p(e).$implicit,c=v();return m(c.descargarPdf(a.idPesoMedida))}),i(),t(19,"p-button",19),S("onClick",function(){let a=p(e).$implicit,c=v();return m(c.imprimirPdf(a.idPesoMedida))}),i()(),t(20,"td"),w(21,"p-tag",20),i(),t(22,"td")(23,"p-button",21),S("click",function(){let a=p(e).$implicit,c=v();return m(c.eliminarPesoMedida(a.idPesoMedida))}),i()()()}if(l&2){let e=r.$implicit,n=v();d(2),f(e.idPesoMedida),d(2),f(e.fecha),d(2),f(e.cliente),d(2),f(e.empresaTransporte),d(2),at("",e.placaPrincipal,"/",e.placaSecundario),d(2),at("",e.serie,"/",e.numero),d(2),f(e.pesoMaxPerm),d(2),f(e.pesoBrutoTransp),d(2),u("rounded",!0)("text",!0),d(),u("rounded",!0)("text",!0),d(2),u("value",e.estado)("severity",n.getSeverity(e.estado)),d(2),u("disabled",n.isDeleteDisabled(e.estado))("rounded",!0)("outlined",!0)}}function Ni(l,r){l&1&&(t(0,"tr")(1,"td",22),o(2,"Sin Datos"),i()())}var $e=class l{constructor(r,e,n){this.pesoMedidaService=r;this.service=e;this.confirmationService=n}calendarValue=new Date;pesosMedidas;pdfSrc;disabledButton=!1;ngOnInit(){}buscarPesosMedidas(){let r=re(this.calendarValue,"yyyy-MM-dd","en-US");this.pesoMedidaService.searchByDate(r).subscribe(e=>{e&&e.length?this.pesosMedidas=e:(this.service.add({severity:"error",summary:"Sin resultados",detail:"No se encontraron datos para la fecha seleccionada.",life:5e3}),this.pesosMedidas=e)},e=>{this.service.add({severity:"error",summary:"Error de conexi\xF3n",detail:"Ocurri\xF3 un error al consultar los datos.",life:5e3}),console.error("Error al consultar peso destare:",e)})}checkDate(){this.calendarValue||(this.calendarValue=new Date)}descargarPdf(r){this.pesoMedidaService.generatePdf(r).subscribe({next:e=>{let n=new Blob([e],{type:"application/pdf"});(0,Lt.saveAs)(n,`peso_medida_${r}.pdf`),this.service.add({severity:"success",summary:"Descarga exitosa",detail:`El PDF de la medida ${r} se descarg\xF3 correctamente.`})},error:e=>{console.error("Error al generar PDF:",e),this.service.add({severity:"error",summary:"Error",detail:"No se pudo generar el PDF. Int\xE9ntalo nuevamente."})}})}imprimirPdf(r){let e=window.open("","_blank");this.pesoMedidaService.generatePdf(r).subscribe({next:n=>{let a=new Blob([n],{type:"application/pdf"}),c=URL.createObjectURL(a);try{e?e.location.href=c:window.location.href=c}finally{setTimeout(()=>URL.revokeObjectURL(c),5e3)}},error:n=>{console.error("Error al generar PDF:",n),e&&e.close(),this.mostrarError("No se pudo generar el PDF. Int\xE9ntalo nuevamente.")}})}mostrarError(r){alert(r)}getSeverity(r){switch(r){case"EMITIDO":return"success";case"ANULADO":return"warn";default:return"info"}}isDeleteDisabled(r){return r==="ANULADO"}eliminarPesoMedida(r){this.confirmationService.confirm({target:event.target,message:"Esta seguro que quiere eliminar?",header:"Eliminacion de Peso Medida",closable:!0,closeOnEscape:!0,icon:"pi pi-exclamation-triangle",rejectButtonProps:{label:"Cancelar",severity:"secondary",outlined:!0},acceptButtonProps:{label:"Si"},accept:()=>{this.pesoMedidaService.anularPesoMedida(r).subscribe({}),this.service.add({severity:"success",summary:"Exito",detail:"Peso Medida Anulado",life:5e3}),this.buscarPesosMedidas()}})}static \u0275fac=function(e){return new(e||l)(b(ne),b(X),b(Ve))};static \u0275cmp=k({type:l,selectors:[["app-consultpesomedida"]],decls:21,vars:8,consts:[["header",""],["body",""],["emptymessage",""],[1,"flex"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],[1,"grid","grid-cols-12","gap-4","grid-cols-12","gap-2"],["for","email3",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],[1,"col-span-12","md:col-span-2"],[3,"ngModelChange","onBlur","ngModel","showIcon","readonlyInput","dateFormat"],["label","Buscar","icon","pi pi-check",3,"onClick","fluid"],[1,"card","mt-3"],["emptyMessage","Sin datos",3,"value","rows","paginator"],["position","top-right"],["pFrozenColumn","",1,"font-bold",2,"min-width","50px"],["pFrozenColumn","",1,"font-bold",2,"min-width","120px"],["pFrozenColumn","",1,"font-bold",2,"min-width","200px"],["pFrozenColumn","",1,"font-bold",2,"min-width","100px"],["icon","pi pi-download","tooltipPosition","top","pTooltip","Descargar",3,"onClick","rounded","text"],["icon","pi pi-print","tooltipPosition","top","pTooltip","Imprimir",3,"onClick","rounded","text"],[3,"value","severity"],["icon","pi pi-trash","severity","danger",3,"click","disabled","rounded","outlined"],["colspan","11"]],template:function(e,n){if(e&1){let a=T();t(0,"p-fluid")(1,"div",3)(2,"div",4)(3,"div",5),o(4,"Consulta de Pesos y Medidas"),i(),t(5,"div",6)(6,"label",7),o(7,"Fecha:"),i(),t(8,"div",8)(9,"p-datepicker",9),_("ngModelChange",function(s){return p(a),g(n.calendarValue,s)||(n.calendarValue=s),m(s)}),S("onBlur",function(){return p(a),m(n.checkDate())}),i()(),t(10,"p-button",10),S("onClick",function(){return p(a),m(n.buscarPesosMedidas())}),i()()()(),t(11,"div",11)(12,"p-table",12),M(13,Li,23,0,"ng-template",null,0,C)(15,Oi,24,19,"ng-template",null,1,C)(17,Ni,3,0,"ng-template",null,2,C),i()()(),w(19,"p-confirmDialog")(20,"p-toast",13)}e&2&&(d(9),h("ngModel",n.calendarValue),u("showIcon",!0)("readonlyInput",!0)("dateFormat","dd/mm/yy"),d(),u("fluid",!1),d(2),u("value",n.pesosMedidas)("rows",10)("paginator",!0))},dependencies:[F,G,me,j,H,z,q,Y,pe,Et,De,It,A],encapsulation:2})};var et=class l extends R{privilegioChange=new le;constructor(r){super(r,`${D.HOST}/privilegios`)}getUsuarioPrivilegio(r){return this.http.post(`${this.url}/user`,r)}getPrivilegioChange(){return this.privilegioChange.asObservable()}setPrivilegioChange(r){this.privilegioChange.next(r)}static \u0275fac=function(e){return new(e||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var Z=(l,r)=>{let e=we(kt),n=we(et),a=we(Pe);if(!e.isLogged())return e.logout(),!1;let c=new Ft,s=sessionStorage.getItem(D.TOKEN_NAME);if(c.isTokenExpired(s))return e.logout(),!1;{let x=c.decodeToken(s).sub;return n.getUsuarioPrivilegio(x).pipe(ht(y=>{n.setPrivilegioChange(y);let B=l.data.privilegio;return y.some(L=>L.descripcion===B)?!0:(a.navigate(["/pages/not-403"]),!1)}))}};var tt=class l{static \u0275fac=function(e){return new(e||l)};static \u0275cmp=k({type:l,selectors:[["app-not403"]],decls:13,vars:0,consts:[[1,"flex","flex-col","items-center","justify-center"],[2,"border-radius","56px","padding","0.3rem","background","linear-gradient(180deg, rgba(247, 149, 48, 0.4) 10%, rgba(247, 149, 48, 0) 30%)"],[1,"w-full","bg-surface-0","dark:bg-surface-900","py-20","px-8","sm:px-20","flex","flex-col","items-center",2,"border-radius","53px"],[1,"gap-4","flex","flex-col","items-center"],[1,"flex","justify-center","items-center","border-2","border-orange-500","rounded-full",2,"width","3.2rem","height","3.2rem"],[1,"text-orange-500","pi","pi-fw","pi-lock","text-2xl!"],[1,"text-surface-900","dark:text-surface-0","font-bold","text-4xl","lg:text-5xl","mb-2"],[1,"text-muted-color","mb-8"],["src","https://primefaces.org/cdn/templates/sakai/auth/asset-access.svg","alt","Access denied","width","80%",1,"mb-8"],[1,"col-span-12","mt-8","text-center"],["label","Go to Dashboard","routerLink","/pages/dashboard","severity","warn"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),w(5,"i",5),i(),t(6,"h1",6),o(7,"Acceso denegado"),i(),t(8,"span",7),o(9,"No tienes los permisos necesarios. Ponte en contacto con los administradores."),i(),w(10,"img",8),t(11,"div",9),w(12,"p-button",10),i()()()()())},dependencies:[F,j,K],encapsulation:2})};var Hi=()=>["/pages/reg-peso-medida"],it=class l{constructor(r,e){this.route=r;this.pesoMedidaService=e}id_Peso_Medida;ngOnInit(){this.route.params.subscribe(r=>{this.id_Peso_Medida=r.id_peso_medida})}imprimir(r){this.pesoMedidaService.generatePdf(r).subscribe({next:e=>{let n=new Blob([e],{type:"application/pdf"}),a=URL.createObjectURL(n),c=window.open("","_blank","width=900,height=700,toolbar=yes,scrollbars=yes,resizable=yes");c?(c.document.write(`
          <html>
            <head><title>PDF ${r}</title></head>
            <body style="margin:0">
              <embed src="${a}" type="application/pdf" width="100%" height="100%" />
              <script>
                window.onload = function() {
                  setTimeout(() => {
                    window.print();
                  }, 1000);
                };
              <\/script>
            </body>
          </html>
        `),c.document.close()):alert("El navegador bloque\xF3 la apertura de una nueva ventana. Habilita popups."),setTimeout(()=>URL.revokeObjectURL(a),5e3)},error:e=>{console.error("Error al generar PDF",e),alert("No se pudo generar el PDF. Intenta nuevamente.")}})}static \u0275fac=function(e){return new(e||l)(b(Te),b(ne))};static \u0275cmp=k({type:l,selectors:[["app-detallepesomedida"]],decls:17,vars:5,consts:[[1,"flex","justify-start","w-full"],[1,"card","flex","flex-col","gap-4","w-full","p-4","border","border-green-300","rounded-md","shadow-md","bg-green-50"],[1,"font-semibold","text-xl","text-green-800"],[1,"grid","grid-cols-12","gap-2","items-center"],[1,"col-span-12","md:col-span-2","font-medium","text-green-700"],[1,"col-span-12","md:col-span-10","text-green-900"],[1,"flex","gap-4","justify-start","mt-4"],["label","Nuevo","icon","pi pi-check",3,"routerLink","fluid"],["label","Imprimir","icon","pi pi-print",3,"onClick","fluid"]],template:function(e,n){e&1&&(t(0,"p-fluid")(1,"div",0)(2,"div",1)(3,"div",2),o(4," Peso y Medida Guardado: "),i(),t(5,"div",3)(6,"label",4),o(7,"Tipo:"),i(),t(8,"div",5),o(9,"Peso y Medida"),i(),t(10,"label",4),o(11,"N\xFAmero:"),i(),t(12,"div",5),o(13),i()(),t(14,"div",6),w(15,"p-button",7),t(16,"p-button",8),S("onClick",function(){return n.imprimir(n.id_Peso_Medida)}),i()()()()()),e&2&&(d(13),f(n.id_Peso_Medida),d(2),u("routerLink",O(4,Hi))("fluid",!0),d(),u("fluid",!0))},dependencies:[F,j,H,K,A],encapsulation:2})};var Qr=[{path:"dashboard",component:Ae,canActivate:[Z],data:{privilegio:"EVALUACION_WEB_CONSULTA"}},{path:"evaluacion",component:Be,canActivate:[Z],data:{privilegio:"EVALUACION_WEB_REGISTRO"}},{path:"registrar-evaluacion/:id_pesaje",component:ze,canActivate:[Z],data:{privilegio:"EVALUACION_WEB_REGISTRO"}},{path:"consult-proveedor",component:Ke,canActivate:[Z],data:{privilegio:"EVALUACION_WEB_CONSULTA"}},{path:"consult-fecha",component:Xe,canActivate:[Z],data:{privilegio:"EVALUACION_WEB_CONSULTA"}},{path:"reg-peso-medida",component:Qe,canActivate:[Z],data:{privilegio:"EVALUACION_WEB_REG_PESO_MEDIDA"}},{path:"consult-pesomedida",component:$e,canActivate:[Z],data:{privilegio:"EVALUACION_WEB_CONSULTA_PESO_MEDIDA"}},{path:"resultado/:id_peso_medida",component:it,canActivate:[Z],data:{privilegio:"EVALUACION_WEB_CONSULTA_PESO_MEDIDA"}},{path:"vehiculo",component:Re,canActivate:[Z],data:{privilegio:"EVALUACION_WEB_CONSULTA"}},{path:"not-403",component:tt}];export{Qr as pagesRoutes};
