import{Aa as ge,Ba as Pt,Ca as Vt,Da as It,Ea as Ie,Fa as kt,G as Me,Ga as R,H as Q,Ha as Dt,Ia as k,J as bt,Ja as Rt,T as $,U as z,V as q,W as Ct,X as xt,Y as yt,a as de,c as ce,d as me,ea as N,g as B,ha as Et,ia as L,k as I,ma as ee,p as Ee,pa as pe,qa as Te,r as we,ra as Pe,s as K,sa as wt,ta as te,ua as H,va as ue,wa as Ve,xa as ie,ya as Mt,za as Tt}from"./chunk-H3TSF572.js";import{$b as b,Ca as d,Db as at,Gb as Z,Ha as C,Ib as o,Jb as g,Kb as A,L as Se,Lb as lt,Mb as st,Na as D,Nb as _,Ob as f,Pb as h,Qb as St,R as V,Sa as w,Sb as j,Tb as se,V as P,W as Ce,a as ae,aa as m,b as ht,ba as p,d as Nt,e as Ht,fb as u,gb as t,hb as i,ib as y,l as le,mb as xe,nb as ye,pb as T,t as vt,tb as S,ub as v}from"./chunk-T73Y6ZVN.js";var Bt=Nt((ut,gt)=>{(function(l,r){typeof define=="function"&&define.amd?define([],r):typeof ut<"u"?r():(r(),l.FileSaver={})})(ut,function(){"use strict";function l(x,E){return typeof E>"u"?E={autoBom:!1}:typeof E!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),E={autoBom:!E}),E.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(x.type)?new Blob(["\uFEFF",x],{type:x.type}):x}function r(x,E,U){var M=new XMLHttpRequest;M.open("GET",x),M.responseType="blob",M.onload=function(){s(M.response,E,U)},M.onerror=function(){console.error("could not download file")},M.send()}function e(x){var E=new XMLHttpRequest;E.open("HEAD",x,!1);try{E.send()}catch{}return 200<=E.status&&299>=E.status}function n(x){try{x.dispatchEvent(new MouseEvent("click"))}catch{var E=document.createEvent("MouseEvents");E.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),x.dispatchEvent(E)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,c=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(x,E,U){var M=a.URL||a.webkitURL,O=document.createElement("a");E=E||x.name||"download",O.download=E,O.rel="noopener",typeof x=="string"?(O.href=x,O.origin===location.origin?n(O):e(O.href)?r(x,E,U):n(O,O.target="_blank")):(O.href=M.createObjectURL(x),setTimeout(function(){M.revokeObjectURL(O.href)},4e4),setTimeout(function(){n(O)},0))}:"msSaveOrOpenBlob"in navigator?function(x,E,U){if(E=E||x.name||"download",typeof x!="string")navigator.msSaveOrOpenBlob(l(x,U),E);else if(e(x))r(x,E,U);else{var M=document.createElement("a");M.href=x,M.target="_blank",setTimeout(function(){n(M)})}}:function(x,E,U,M){if(M=M||open("","_blank"),M&&(M.document.title=M.document.body.innerText="downloading..."),typeof x=="string")return r(x,E,U);var O=x.type==="application/octet-stream",At=/constructor/i.test(a.HTMLElement)||a.safari,ft=/CriOS\/[\d]+/.test(navigator.userAgent);if((ft||O&&At||c)&&typeof FileReader<"u"){var rt=new FileReader;rt.onloadend=function(){var ve=rt.result;ve=ft?ve:ve.replace(/^data:[^;]*;/,"data:attachment/file;"),M?M.location.href=ve:location=ve,M=null},rt.readAsDataURL(x)}else{var _t=a.URL||a.webkitURL,ot=_t.createObjectURL(x);M?M.location=ot:location.href=ot,M=null,setTimeout(function(){_t.revokeObjectURL(ot)},4e4)}});a.saveAs=s.saveAs=s,typeof gt<"u"&&(gt.exports=s)})});var ke=class{codigo_et;empresa;estado};var De=class{id_vehiculo;codigo_et;tipo;marca;estado;placa;alto;ancho;largo;constancia;configuracion_vehicular;peso_max_permitido};var W=class l{constructor(r,e){this.http=r;this.url=e}findAll(){return this.http.get(this.url)}findById(r){return this.http.get(`${this.url}/${r}`)}save(r){debugger;return this.http.post(this.url,r)}update(r,e){return this.http.put(`${this.url}/${r}`,e)}delete(r){return this.http.delete(`${this.url}/${r}`)}static \u0275fac=function(e){return new(e||l)(P(I),P("url"))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var Re=class l extends W{constructor(e){super(e,`${k.HOST}/vehiculos`);this.http=e}vehiculoChnage=new le;listarVehiculos(){return this.http.get(`${this.url}/buscar`)}setVehiculoChange(e){this.vehiculoChnage.next(e)}getVehiculoChange(){return this.vehiculoChnage.asObservable()}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var We=class l extends W{constructor(e){super(e,`${k.HOST}/empresaTransportes`);this.http=e}listarEmpresaTransporte(){return this.http.get(`${this.url}/buscar`)}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var Kt=()=>["idVehiculo","empresa","placa","marca","tipo","alto","ancho","largo","constancia","configuracion","permitido"],Xt=()=>({width:"600px"}),Jt=()=>({width:"700px"}),Yt=()=>["codigoEt","empresa","estado"];function Zt(l,r){if(l&1){let e=T();t(0,"p-button",14),S("click",function(){m(e);let a=v();return p(a.abrirNuevo())}),i()}}function Qt(l,r){if(l&1){let e=T();t(0,"div",15)(1,"h5",16),o(2,"Gestion de Vehiculos"),i(),t(3,"p-iconfield"),y(4,"p-inputicon",17),t(5,"input",18),S("input",function(a){m(e);let c=v(),s=at(5);return p(c.filtrarVehiculos(s,a))}),i()()()}}function $t(l,r){l&1&&(t(0,"tr")(1,"th"),o(2,"Id"),i(),t(3,"th"),o(4,"Empresa Transporte"),i(),t(5,"th"),o(6,"Placa"),i(),t(7,"th"),o(8,"Marca"),i(),t(9,"th"),o(10,"Tipo"),i(),t(11,"th"),o(12,"Alto"),i(),t(13,"th"),o(14,"Ancho"),i(),t(15,"th"),o(16,"Largo"),i(),t(17,"th"),o(18,"Constancia"),i(),t(19,"th"),o(20,"Conf. Vehicular"),i(),t(21,"th"),o(22,"Peso Max Perm."),i(),t(23,"th"),o(24,"Acciones"),i()())}function ei(l,r){if(l&1){let e=T();t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),o(14),i(),t(15,"td"),o(16),i(),t(17,"td"),o(18),i(),t(19,"td"),o(20),i(),t(21,"td"),o(22),i(),t(23,"td")(24,"p-button",19),S("click",function(){let a=m(e).$implicit,c=v();return p(c.editarVehiculo(a))}),i(),y(25,"p-button",20),i()()}if(l&2){let e=r.$implicit;d(2),g(e.idVehiculo),d(2),g(e.empresa),d(2),g(e.placa),d(2),g(e.marca),d(2),g(e.tipo),d(2),g(e.alto),d(2),g(e.ancho),d(2),g(e.largo),d(2),g(e.constancia),d(2),g(e.configuracion),d(2),g(e.permitido),d(2),u("rounded",!0)("outlined",!0),d(),u("rounded",!0)("outlined",!0)}}function ti(l,r){if(l&1){let e=T();xe(0),t(1,"div",27)(2,"div",22)(3,"label",32),o(4,"Peso. Max Permi: "),i(),t(5,"input",41),h("ngModelChange",function(a){m(e);let c=v(2);return f(c.peso_max,a)||(c.peso_max=a),p(a)}),i()(),t(6,"div",22)(7,"label",23),o(8,"Conf. Vehicular:"),i(),t(9,"input",42),h("ngModelChange",function(a){m(e);let c=v(2);return f(c.confg_Vehicular,a)||(c.confg_Vehicular=a),p(a)}),i()()(),ye()}if(l&2){let e=v(2);d(5),_("ngModel",e.peso_max),d(4),_("ngModel",e.confg_Vehicular)}}function ii(l,r){if(l&1){let e=T();t(0,"p-fluid")(1,"div",21)(2,"div",22)(3,"label",23),o(4,"Placa:"),i(),t(5,"input",24),h("ngModelChange",function(a){m(e);let c=v();return f(c.idVehiculo,a)||(c.idVehiculo=a),p(a)}),i(),t(6,"input",25),h("ngModelChange",function(a){m(e);let c=v();return f(c.placa,a)||(c.placa=a),p(a)}),i()(),t(7,"div",22)(8,"label",23),o(9,"Alto:"),i(),t(10,"input",26),h("ngModelChange",function(a){m(e);let c=v();return f(c.alto,a)||(c.alto=a),p(a)}),i()()(),t(11,"div",27)(12,"div",22)(13,"label",23),o(14,"Marca:"),i(),t(15,"input",28),h("ngModelChange",function(a){m(e);let c=v();return f(c.marca,a)||(c.marca=a),p(a)}),i()(),t(16,"div",22)(17,"label",23),o(18,"Ancho:"),i(),t(19,"input",29),h("ngModelChange",function(a){m(e);let c=v();return f(c.ancho,a)||(c.ancho=a),p(a)}),i()()(),t(20,"div",27)(21,"div",22)(22,"label",23),o(23,"Tarj. U.C o C.H.V.E.:"),i(),t(24,"input",30),h("ngModelChange",function(a){m(e);let c=v();return f(c.constancia,a)||(c.constancia=a),p(a)}),i()(),t(25,"div",22)(26,"label",23),o(27,"Largo:"),i(),t(28,"input",31),h("ngModelChange",function(a){m(e);let c=v();return f(c.largo,a)||(c.largo=a),p(a)}),i()()(),t(29,"div",27)(30,"div",22)(31,"label",32),o(32,"Tipo: "),i(),t(33,"p-select",33),h("ngModelChange",function(a){m(e);let c=v();return f(c.tipoSeleccionado,a)||(c.tipoSeleccionado=a),p(a)}),i()()(),w(34,ti,10,2,"ng-container",34),y(35,"p-divider"),t(36,"div",27)(37,"label",35),o(38,"Empresa Transporte: "),i(),t(39,"div",36)(40,"p-iconfield",37)(41,"input",38),h("ngModelChange",function(a){m(e);let c=v();return f(c.empresaSeleccionado.empresa,a)||(c.empresaSeleccionado.empresa=a),p(a)}),i(),t(42,"p-inputicon",39),S("click",function(){m(e);let a=v();return p(a.abrirEmpresaTransporte())}),i()(),t(43,"input",40),h("ngModelChange",function(a){m(e);let c=v();return f(c.empresaSeleccionado.codigoEt,a)||(c.empresaSeleccionado.codigoEt=a),p(a)}),i()()()()}if(l&2){let e=v();d(5),_("ngModel",e.idVehiculo),u("hidden",!0),d(),_("ngModel",e.placa),d(4),_("ngModel",e.alto),d(5),_("ngModel",e.marca),d(4),_("ngModel",e.ancho),d(5),_("ngModel",e.constancia),d(4),_("ngModel",e.largo),d(5),_("ngModel",e.tipoSeleccionado),u("options",e.tipo),d(),u("ngIf",e.tipoSeleccionado!=="Remolque"),d(7),_("ngModel",e.empresaSeleccionado.empresa),d(2),_("ngModel",e.empresaSeleccionado.codigoEt),u("hidden",!0)}}function ni(l,r){if(l&1){let e=T();t(0,"p-button",43),S("click",function(){m(e);let a=v();return p(a.saveVehiculo())}),i(),y(1,"p-button",44)}}function ri(l,r){l&1&&(t(0,"tr")(1,"th"),o(2,"Id"),i(),t(3,"th"),o(4,"Nombre"),i(),t(5,"th"),o(6,"Estado"),i()())}function oi(l,r){if(l&1&&(t(0,"tr",55)(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i()()),l&2){let e=r.$implicit;u("pSelectableRow",e),d(2),g(e.codigoEt),d(2),g(e.empresa),d(2),g(e.estado)}}function ai(l,r){if(l&1){let e=T();t(0,"p-fluid")(1,"p-toolbar",45)(2,"div",46)(3,"label",47),o(4,"Buscar:"),i(),t(5,"div",48)(6,"div",49)(7,"input",50),S("input",function(a){m(e);let c=at(11),s=v();return p(s.filtrarEmpresas(c,a))}),i()(),t(8,"div",51),y(9,"button",52),i()()()(),t(10,"p-table",53,7),h("selectionChange",function(a){m(e);let c=v();return f(c.seleccionarFila,a)||(c.seleccionarFila=a),p(a)}),w(12,ri,7,0,"ng-template",null,3,b)(14,oi,7,4,"ng-template",null,4,b),i(),t(16,"p-button",54),S("onClick",function(){m(e);let a=v();return p(a.seleccionarEmpresaTransp())}),i()()}if(l&2){let e=v();d(10),u("value",e.empresa)("rows",5)("paginator",!0),_("selection",e.seleccionarFila),u("globalFilterFields",j(6,Yt)),d(6),u("fluid",!1)}}var Fe=class l{constructor(r,e,n){this.vehiculoService=r;this.empresaTransporteService=e;this.service=n}vehiculos=[];vehiculoDialog=!1;empresaTransporteDialog=!1;vehiculo;tipoSeleccionado;empresa=[];seleccionarFila={};empresaSeleccionado={};tipo;titulo;idVehiculo;placa;alto;marca;ancho;constancia;largo;peso_max;confg_Vehicular;codigo_et;ngOnInit(){this.tipo=[{label:"Camion",value:"Camion"},{label:"Remolcador",value:"Remolcador"},{label:"Volquete",value:"Volquete"},{label:"Camioneta",value:"Camioneta"},{label:"Remolque",value:"Remolque"},{label:"Moto Cargo",value:"Moto Cargo"}],this.vehiculoService.listarVehiculos().subscribe(r=>{this.createTable(r)}),this.vehiculoService.getVehiculoChange().subscribe(r=>this.createTable(r))}createTable(r){this.vehiculos=r}abrirNuevo(){this.titulo="REGISTRAR VEHICULO",this.vehiculoDialog=!0}abrirEmpresaTransporte(){this.empresaTransporteDialog=!0,this.listarEmpresaTrasport()}listarEmpresaTrasport(){this.empresaTransporteService.listarEmpresaTransporte().subscribe(r=>{this.empresa=r})}seleccionarEmpresaTransp(){this.seleccionarFila&&this.seleccionarFila.codigoEt&&(this.empresaSeleccionado=ae({},this.seleccionarFila),this.empresaTransporteDialog=!1)}saveVehiculo(){let r=new ke;r.codigo_et=this.empresaSeleccionado.codigoEt;let e=new De;e.id_vehiculo=this.idVehiculo,e.codigo_et=r,e.tipo=this.tipoSeleccionado,e.marca=this.marca,e.estado="ACTIVO",e.placa=this.placa,e.alto=this.alto,e.ancho=this.ancho,e.largo=this.largo,e.constancia=this.constancia,e.configuracion_vehicular=this.confg_Vehicular,e.peso_max_permitido=this.peso_max,e.id_vehiculo?this.vehiculoService.update(this.idVehiculo,e).pipe(Se(()=>this.vehiculoService.listarVehiculos())).subscribe({next:n=>{this.vehiculoService.setVehiculoChange(n),this.service.add({severity:"info",summary:"Notificaci\xF3n",detail:"Datos actualizado Correctamente",life:6e3})},error:()=>{this.service.add({severity:"error",summary:"Error",detail:"No registrado",life:6e3})}}):this.vehiculoService.save(e).pipe(Se(()=>this.vehiculoService.listarVehiculos())).subscribe({next:n=>{this.vehiculoService.setVehiculoChange(n),this.service.add({severity:"success",summary:"Correcto",detail:"Evaluacion registrada correctamente!",life:6e3})},error:()=>{this.service.add({severity:"error",summary:"Error",detail:"No registrado",life:6e3})}}),this.vehiculoDialog=!1,this.resetFormulario()}editarVehiculo(r){this.idVehiculo=r.idVehiculo,this.placa=r.placa,this.alto=r.alto,this.marca=r.marca,this.ancho=r.ancho,this.constancia=r.constancia,this.largo=r.largo,this.tipoSeleccionado=r.tipo,this.peso_max=r.permitido,this.confg_Vehicular=r.configuracion,this.empresaSeleccionado={empresa:r.empresa,codigoEt:r.codigoEt||""},this.titulo="Editar Veh\xEDculo",this.vehiculoDialog=!0}resetFormulario(){this.idVehiculo=0,this.placa="",this.alto="",this.marca="",this.ancho="",this.constancia="",this.largo="",this.tipoSeleccionado="",this.peso_max=null,this.confg_Vehicular="",this.empresaSeleccionado={empresa:"",codigoEt:""}}filtrarVehiculos(r,e){r.filterGlobal(e.target.value,"contains")}filtrarEmpresas(r,e){r.filterGlobal(e.target.value,"contains")}static \u0275fac=function(e){return new(e||l)(C(Re),C(We),C(Q))};static \u0275cmp=D({type:l,selectors:[["app-vehiculo"]],decls:21,vars:20,consts:[["start",""],["dtvehiculo",""],["caption",""],["header",""],["body",""],["content",""],["footer",""],["dtempresa",""],[1,"card"],[1,"mb-6"],["currentPageReportTemplate","Mostrando {first} to {last} de {totalRecords} vehiculos",3,"value","rowHover","showCurrentPageReport","rows","paginator","globalFilterFields"],[3,"visibleChange","visible","header","modal"],["header","Buscar Empresa Transporte",3,"visibleChange","visible","modal"],["position","top-right"],["label","Nuevo","icon","pi pi-plus",1,"mr-2",3,"click"],[1,"flex","items-center","justify-between"],[1,"m-0"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["icon","pi pi-pencil",1,"mr-2",3,"click","rounded","outlined"],["icon","pi pi-trash","severity","danger",3,"rounded","outlined"],[1,"flex","flex-col","md:flex-row","gap-6"],[1,"flex","flex-wrap","gap-2","w-full"],["for","numTicket"],["pInputText","","id","id_vehiculo","type","text",3,"ngModelChange","ngModel","hidden"],["pInputText","","id","numTicket","type","text","placeholder","X6Y-985",3,"ngModelChange","ngModel"],["pInputText","","id","numTicket","type","text","placeholder","3.60",3,"ngModelChange","ngModel"],[1,"flex","flex-col","md:flex-row","gap-6","mt-3"],["pInputText","","id","numTicket","type","text","placeholder","VOLVO",3,"ngModelChange","ngModel"],["pInputText","","id","numTicket","type","text","placeholder","2.10",3,"ngModelChange","ngModel"],["pInputText","","id","numTicket","type","text","placeholder","15M24054E",3,"ngModelChange","ngModel"],["pInputText","","id","numTicket","type","text","placeholder","5.40",3,"ngModelChange","ngModel"],["for","state"],["id","state","optionLabel","label","optionValue","value","placeholder","Seeleccionar","appendTo","body",1,"w-full",3,"ngModelChange","ngModel","options"],[4,"ngIf"],["for","email3",1,"flex"],[1,"w-full"],["iconPosition","left"],["pInputText","","type","text","placeholder","TRANSPORTE PAUCARS",3,"ngModelChange","ngModel"],[1,"pi","pi-search",2,"cursor","pointer",3,"click"],["pInputText","","type","text",3,"ngModelChange","ngModel","hidden"],["pInputText","","id","numTicket","type","text","placeholder","51.420",3,"ngModelChange","ngModel"],["pInputText","","id","numTicket","type","text","placeholder","T3S",3,"ngModelChange","ngModel"],["label","Guardar","icon","pi pi-check",3,"click"],["label","Cancel","icon","pi pi-times","text",""],[1,"mb-2"],[1,"grid","grid-cols-12","gap-4","items-center"],["for","name3",1,"col-span-12","md:col-span-3"],[1,"col-span-12","md:col-span-9","flex","gap-2"],[1,"flex-grow"],["pInputText","","id","name3","type","text",1,"w-full",3,"input"],[2,"flex","0 0 auto"],["pButton","","type","button","label","Buscar",1,"p-button","p-button-info"],["selectionMode","single","dataKey","codigoEt",3,"selectionChange","value","rows","paginator","selection","globalFilterFields"],["icon","pi pi-check","label","Seleccionar",3,"onClick","fluid"],[3,"pSelectableRow"]],template:function(e,n){if(e&1){let a=T();t(0,"div",8)(1,"p-toolbar",9),w(2,Zt,1,0,"ng-template",null,0,b),i(),t(4,"p-table",10,1),w(6,Qt,6,0,"ng-template",null,2,b)(8,$t,25,0,"ng-template",null,3,b)(10,ei,26,15,"ng-template",null,4,b),i()(),t(12,"p-dialog",11),h("visibleChange",function(s){return m(a),f(n.vehiculoDialog,s)||(n.vehiculoDialog=s),p(s)}),w(13,ii,44,14,"ng-template",null,5,b)(15,ni,2,0,"ng-template",null,6,b),i(),t(17,"p-dialog",12),h("visibleChange",function(s){return m(a),f(n.empresaTransporteDialog,s)||(n.empresaTransporteDialog=s),p(s)}),w(18,ai,17,7,"ng-template",null,5,b),i(),y(20,"p-toast",13)}e&2&&(d(4),u("value",n.vehiculos)("rowHover",!0)("showCurrentPageReport",!0)("rows",10)("rowHover",!0)("paginator",!0)("globalFilterFields",j(17,Kt)),d(8),Z(j(18,Xt)),u("header",St(n.titulo)),_("visible",n.vehiculoDialog),u("modal",!0),d(5),Z(j(19,Jt)),_("visible",n.empresaTransporteDialog),u("modal",!0))},dependencies:[R,H,Ve,Et,L,N,ee,$,z,q,te,ie,Te,Pe,ge,Vt,It,B,me],encapsulation:2})};var G=class l extends W{constructor(e){super(e,`${k.HOST}/peso`);this.http=e}listarTicketsPorEstado(){return this.http.get(`${this.url}/destarar`)}listarPesajePorId(e){return this.http.get(`${this.url}/${e}`)}searchByDate(e){return this.http.get(`${this.url}/search/date?date=${e}`)}searchByProveedorAnioMes(e,n,a){return this.http.get(`${this.url}/buscar/${e}/${n}/${a}`)}listarPesajePorNumTicket(e){return this.http.get(`${this.url}/search/ticket/${e}`)}buscarHastaHora(e){return this.http.get(`${this.url}/prueba/date`,{params:{date:e}})}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};function li(l,r){if(l&1&&(t(0,"div",6)(1,"div",7)(2,"div")(3,"span",8),o(4),i(),t(5,"div",9),o(6),i()(),t(7,"div",10),y(8,"i",11),i()(),t(9,"span",12),o(10),i()()),l&2){let e=r.$implicit,n=v();d(4),g(e.tipoOperacion),d(2),g(n.kgAToneladas(e.pesoNeto)),d(4),g(e.descripcion)}}var Be=class l{constructor(r){this.pesodestareService=r}resultados=[];fechaHoraActual;newFechaHoraActual;ngOnInit(){debugger;this.setFechaHoraActual(),this.pesodestareService.buscarHastaHora(this.fechaHoraActual).subscribe(e=>{this.resultados=e});let r=new Date().toLocaleString("es-PE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0});this.newFechaHoraActual=r}setFechaHoraActual(){let r=new Date;this.fechaHoraActual=r.getFullYear()+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0")+"T"+String(r.getHours()).padStart(2,"0")+":"+String(r.getMinutes()).padStart(2,"0")+":"+String(r.getSeconds()).padStart(2,"0")}kgAToneladas(r){return r/1e3}static \u0275fac=function(e){return new(e||l)(C(G))};static \u0275cmp=D({type:l,selectors:[["app-dashboard"]],decls:7,vars:2,consts:[[1,"grid","gap-8"],[1,"flex"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],[1,"grid","grid-cols-1","md:grid-cols-2","xl:grid-cols-4","gap-6"],["class","card flex flex-col justify-between h-48 transition-shadow shadow-md hover:shadow-xl",4,"ngFor","ngForOf"],[1,"card","flex","flex-col","justify-between","h-48","transition-shadow","shadow-md","hover:shadow-xl"],[1,"flex","justify-between","mb-4"],[1,"block","text-muted-color","font-medium","mb-4"],[1,"text-surface-900","dark:text-surface-0","font-medium","text-xl"],[1,"flex","items-center","justify-center","bg-green-100","dark:bg-green-400/10","rounded-border","w-10","h-10"],[1,"pi","pi-dollar","text-green-500","text-xl"],[1,"text-muted-color"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),o(4),i(),t(5,"div",4),w(6,li,11,3,"div",5),i()()()()),e&2&&(d(4),A("Informaci\xF3n de Balanza: ",n.newFechaHoraActual),d(2),u("ngForOf",n.resultados))},dependencies:[R,B,ce],encapsulation:2})};var si=()=>({"min-width":"60rem"}),di=l=>["/pages/registrar-evaluacion",l];function ci(l,r){if(l&1){let e=T();t(0,"div",5)(1,"span",6),o(2,"Pesos Pendientes"),i(),t(3,"p-button",7),S("click",function(){m(e);let a=v();return p(a.recargarDatos())}),i()()}}function mi(l,r){l&1&&(t(0,"tr")(1,"th"),o(2,"NumTicket"),i(),t(3,"th"),o(4,"Proveedor"),i(),t(5,"th"),o(6,"Vehiculo"),i(),t(7,"th"),o(8,"Transportista"),i(),t(9,"th"),o(10,"Acciones"),i()())}function pi(l,r){if(l&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),y(10,"p-button",8),i()()),l&2){let e=r.$implicit;d(2),g(e.numTicket),d(2),g(e.proveedor),d(2),g(e.placa),d(2),g(e.transportista),d(2),u("routerLink",se(5,di,e.idPesaje))}}var Oe=class l{constructor(r){this.pesoDestareService=r}pesoDestare;cargando=!1;ngOnInit(){this.pesoDestareService.listarTicketsPorEstado().subscribe(r=>{this.pesoDestare=r})}recargarDatos(){window.location.reload()}static \u0275fac=function(e){return new(e||l)(C(G))};static \u0275cmp=D({type:l,selectors:[["app-evaluacion-calidad"]],decls:8,vars:3,consts:[["caption",""],["header",""],["body",""],[1,"card"],[3,"value","tableStyle"],[1,"flex","items-center","justify-between"],[1,"text-xl","font-bold"],["icon","pi pi-refresh","rounded","","raised","",3,"click"],["label","Registrar","routerLinkActive","router-link-active",3,"routerLink"]],template:function(e,n){e&1&&(t(0,"div",3)(1,"p-table",4),w(2,ci,4,0,"ng-template",null,0,b)(4,mi,11,0,"ng-template",null,1,b)(6,pi,11,7,"ng-template",null,2,b),i()()),e&2&&(d(),u("value",n.pesoDestare)("tableStyle",j(2,si)))},dependencies:[R,H,L,K,B],encapsulation:2})};var Ae=class{id_control;id_pesaje;campa\u00F1a;tipo_racimo;condicion;usuario};var Ne=class{id_criterio;codigo_um;descripcion;castigo;forma_castigo;factor_castigo;factor_variable;impresion_ticket;estado;usuario};var He=class{id_evaluacion;id_pesaje;id_criterio;valor;codigo_um;castigo;forma_castigo;factor_castigo;usuario;estado;usuario_mod;fecha_mod;tam_rac};var oe=class{id_pesaje;num_ticket;tipo_operacion;id_to;codigo;fecha;peso_ingreso;peso_salida;peso_neto;castigo_peso;castigo_planilla;id_vehiculo;codigoEt;conductor;id_parcela;cod_producto;estado;retencion_flete;monto_flete;tipo_registro;observaciones;version;id_liquidacion;usuario_ingreso;usuario_salida;usuario_version;fecha_salida;fecha_anul;bitacora;estado_sinc;reg_guia;serie;numero};var Ge=class l{constructor(r){this.http=r}url=`${k.HOST}/criterioCalidades`;listarCriterioCalidad(){return this.http.get(this.url)}static \u0275fac=function(e){return new(e||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var Ue=class l extends W{constructor(e){super(e,`${k.HOST}/evaluacion_calidad`);this.http=e}evaluacionCalidadChange=new le;listarEvaluacionPorIdPesaje(e){return this.http.get(`${this.url}/buscar/${e}`)}eliminarEvaluacionCalidad(e){return this.http.put(`${this.url}/delete/${e}`,{},{responseType:"text"})}setEvaluacionCalidadChange(e){this.evaluacionCalidadChange.next(e)}getEvaluacionCalidadChange(){return this.evaluacionCalidadChange.asObservable()}existsActivoByPesajeAndCriterio(e,n){return this.http.get(`${this.url}/existe/${e}/${n}`)}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var ze=class l extends W{constructor(e){super(e,`${k.HOST}/controlrff`);this.http=e}buscarPorByIdPesaje(e){return this.http.get(`${this.url}/buscar/${e}`)}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var hi=()=>({"min-width":"60rem"}),vi=()=>({position:"absolute",top:"20px",left:"50%",transform:"translateX(-50%)"}),Si=()=>({"max-height":"200px",overflow:"auto"});function bi(l,r){l&1&&(t(0,"tr")(1,"th"),o(2,"Criterio"),i(),t(3,"th"),o(4,"Valor"),i(),t(5,"th"),o(6,"UM"),i(),t(7,"th"),o(8,"Peso Prom."),i(),t(9,"th"),o(10,"Total"),i(),t(11,"th"),o(12,"Acciones"),i()())}function Ci(l,r){if(l&1){let e=T();t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td")(12,"p-button",29),S("click",function(){m(e);let a=v();return p(a.subirArchivo())}),i(),t(13,"p-button",30),S("onClick",function(){let a=m(e).$implicit,c=v();return p(c.eliminarEvaCalidad(a.id_evaluacion))}),i(),y(14,"p-toast"),i()()}if(l&2){let e=r.$implicit,n=v();d(2),g(e.id_criterio.descripcion),d(2),g(e.valor),d(2),g(e.codigo_um),d(2),g(e.factor_castigo),d(2),g(n.redondear(e.factor_castigo*e.valor)),d(2),u("rounded",!0)("text",!0),d(),u("rounded",!0)("text",!0)}}function xi(l,r){if(l&1&&(t(0,"li"),o(1),i()),l&2){let e=r.$implicit;d(),g(e)}}var qe=class l{constructor(r,e,n,a,c,s,x){this.criterioCalidadService=r;this.pesoDestareService=e;this.route=n;this.evaluacionCalidadService=a;this.service=c;this.controRffService=s;this.confirmationService=x}limpieza=[];tipoRacimo=[];criterio_calidad=[];evaluacion_calidad=[];dropdownItems=[{name:"Option 1",code:"Option 1"},{name:"Option 2",code:"Option 2"},{name:"Option 3",code:"Option 3"}];mostrarErrores=!1;errores=[];dropdownItem=null;idPesaje;transportista;numTicket;placa;proveedor;codigo_um;forma_castigo;castigo;factor_castigo;valor;isEdit;selectedValue;campana;racimoSeleccionado;limpiezaSeleccionado;ngOnInit(){this.criterioCalidadService.listarCriterioCalidad().subscribe(r=>this.criterio_calidad=r),this.limpieza=[{label:"Limpio",value:"Limpio"},{label:"Sucio",value:"Sucio"}],this.tipoRacimo=[{label:"Muy Peque\xF1o",value:"Muy Peque\xF1o"},{label:"Peque\xF1o",value:"Peque\xF1o"},{label:"Mediano",value:"Mediano"},{label:"Grande",value:"Grande"}],this.route.params.subscribe(r=>{this.idPesaje=r.id_pesaje,this.isEdit=r.id_pesaje!=null,this.cargarDatos()}),this.evaluacionCalidadService.listarEvaluacionPorIdPesaje(this.idPesaje).subscribe(r=>{this.createTable(r)}),this.evaluacionCalidadService.getEvaluacionCalidadChange().subscribe(r=>this.createTable(r)),this.controRffService.buscarPorByIdPesaje(this.idPesaje).subscribe(r=>{if(r){let e=r[0];this.campana=e.campa\u00F1a,this.racimoSeleccionado=this.tipoRacimo.find(n=>n.value===e.tipo_racimo)||null,this.limpiezaSeleccionado=this.limpieza.find(n=>n.value===e.condicion)||null}else this.campana=""})}createTable(r){this.evaluacion_calidad=r}cargarDatos(){this.pesoDestareService.listarPesajePorId(this.idPesaje).subscribe(r=>{this.numTicket=r.numTicket,this.proveedor=r.proveedor,this.transportista=r.transportista})}seleccionar(){let r=this.criterio_calidad.find(e=>e.id_criterio===this.selectedValue);r&&(this.codigo_um=r.codigo_um.codigo_um,this.forma_castigo=r.forma_castigo,this.castigo=r.castigo,this.factor_castigo=r.factor_castigo)}registrarEvaluacionCalidad(){let r=new oe;r.id_pesaje=this.idPesaje;let e=new Ne;e.id_criterio=this.selectedValue;let n=new He;n.id_pesaje=r,n.id_criterio=e,n.valor=this.valor,n.codigo_um=this.codigo_um,n.castigo=this.castigo,n.forma_castigo=this.forma_castigo,n.factor_castigo=""+this.factor_castigo,n.usuario="VEUSEBIO",n.fecha_mod=null,n.usuario_mod=null,n.estado="Activo",n.tam_rac=null,this.evaluacionCalidadService.existsActivoByPesajeAndCriterio(this.idPesaje,this.selectedValue).subscribe(a=>{a?this.service.add({severity:"error",summary:"Error",detail:"El criterio ya est\xE1 a\xF1adido",life:6e3}):this.evaluacionCalidadService.save(n).pipe(Se(()=>this.evaluacionCalidadService.listarEvaluacionPorIdPesaje(this.idPesaje))).subscribe(c=>{this.evaluacionCalidadService.setEvaluacionCalidadChange(c),this.service.add({severity:"success",summary:"Correcto",detail:"Evaluacion registrada correctamente!",life:6e3})}),this.limpiarCampos()})}limpiarCampos(){this.selectedValue=0,this.valor=null,this.factor_castigo=null}redondear(r){return Math.round(r)}subirArchivo(){this.service.add({severity:"info",summary:"Error Message",detail:"funcionalidad en desarrollo"})}eliminarEvaCalidad(r){this.confirmationService.confirm({target:event.target,message:"Esta seguro que quiere eliminar?",header:"Eliminacion de Evaluacion",closable:!0,closeOnEscape:!0,icon:"pi pi-exclamation-triangle",rejectButtonProps:{label:"Cancelar",severity:"secondary",outlined:!0},acceptButtonProps:{label:"Si"},accept:()=>{this.evaluacionCalidadService.eliminarEvaluacionCalidad(r).subscribe(()=>{this.evaluacionCalidadService.listarEvaluacionPorIdPesaje(this.idPesaje).subscribe(e=>{this.evaluacionCalidadService.setEvaluacionCalidadChange(e)})}),this.service.add({severity:"info",summary:"Confirmado",detail:"Registro eliminado",life:6e3})}})}saveControlRff(){let r=new oe;r.id_pesaje=this.idPesaje;let e=new Ae;e.id_pesaje=r,e.campa\u00F1a=this.campana,e.tipo_racimo=this.racimoSeleccionado.value,e.condicion=this.limpiezaSeleccionado.value,this.controRffService.buscarPorByIdPesaje(this.idPesaje).subscribe(n=>{!n||n.length===0?this.controRffService.save(e).subscribe(()=>{this.service.add({severity:"info",summary:"Notificaci\xF3n",detail:"Datos Guardado Correctamente",life:6e3})}):this.controRffService.update(n[0].id_control,e).subscribe(()=>{this.service.add({severity:"info",summary:"Notificaci\xF3n",detail:"Datos Guardado Correctamente",life:6e3})})})}validarFormulario(){if(this.errores=[],this.selectedValue||this.errores.push("No se ha seleccionado el criterio."),(!this.valor||this.valor<=0)&&this.errores.push("No se ha ingresado el valor."),this.errores.length>0){this.mostrarErrores=!0;return}this.registrarEvaluacionCalidad()}static \u0275fac=function(e){return new(e||l)(C(Ge),C(G),C(Ee),C(Ue),C(Q),C(ze),C(Me))};static \u0275cmp=D({type:l,selectors:[["app-registrar-evaluacion"]],decls:66,vars:32,consts:[["header",""],["body",""],[1,"flex"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],[1,"flex","flex-col","md:flex-row","gap-6"],[1,"flex","flex-wrap","gap-2","w-full"],["for","firstname2"],["pInputText","","id","firstname2","type","text",3,"ngModelChange","ngModel","disabled"],["for","lastname2"],["pInputText","","id","lastname2","type","text",3,"ngModelChange","ngModel","disabled"],[1,"flex","mt-4"],["for","state"],["id","state","optionLabel","descripcion","optionValue","id_criterio","placeholder","Seleccionar ","required","",1,"w-full",3,"ngModelChange","ngModel","options"],["for","zip"],["pInputText","","id","zip","type","number",3,"ngModelChange","ngModel"],["pInputText","","id","zip","type","text",3,"ngModelChange","ngModel","disabled"],["label","Guardar Evaluacion",3,"onClick","fluid"],[1,"flex","flex-col","gap-6"],[3,"value","tableStyle"],["pInputText","","id","zip","type","text",3,"ngModelChange","ngModel"],["id","state","optionLabel","label","placeholder","Seleccionar",1,"w-full",3,"ngModelChange","ngModel","options"],["id","state","optionLabel","label","placeholder","Seeleccionar",1,"w-full",3,"ngModelChange","ngModel","options"],["label","Guardar adicionales",3,"click","fluid"],["label","Regresar","severity","secondary",3,"fluid"],["header","Errores de Validaci\xF3n",3,"visibleChange","visible","modal","closable","contentStyle","baseZIndex"],[1,"list-disc","pl-4"],[4,"ngFor","ngForOf"],["position","top-right"],["icon","pi pi-upload","severity","info",3,"click","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"]],template:function(e,n){if(e&1){let a=T();t(0,"p-fluid")(1,"div",2)(2,"div",3)(3,"div",4),o(4),i(),t(5,"div",5)(6,"div",6)(7,"label",7),o(8,"Titular:"),i(),t(9,"input",8),h("ngModelChange",function(s){return m(a),f(n.proveedor,s)||(n.proveedor=s),p(s)}),i()(),t(10,"div",6)(11,"label",9),o(12,"Transportista"),i(),t(13,"input",10),h("ngModelChange",function(s){return m(a),f(n.transportista,s)||(n.transportista=s),p(s)}),i()()()()(),t(14,"div",11)(15,"div",3)(16,"div",4),o(17,"Registrar Evaluaciones"),i(),t(18,"div",5)(19,"div",6)(20,"label",12),o(21,"Criterio de Evaluacion"),i(),t(22,"p-select",13),h("ngModelChange",function(s){return m(a),f(n.criterio_calidad.values,s)||(n.criterio_calidad.values=s),p(s)})("ngModelChange",function(s){return m(a),f(n.selectedValue,s)||(n.selectedValue=s),p(s)}),S("ngModelChange",function(){return m(a),p(n.seleccionar())}),i()(),t(23,"div",6)(24,"label",14),o(25,"Valor"),i(),t(26,"input",15),h("ngModelChange",function(s){return m(a),f(n.valor,s)||(n.valor=s),p(s)}),i()(),t(27,"div",6)(28,"label",14),o(29,"Factor o Peso Prom"),i(),t(30,"input",16),h("ngModelChange",function(s){return m(a),f(n.factor_castigo,s)||(n.factor_castigo=s),p(s)}),i()()(),t(31,"div",5)(32,"p-button",17),S("onClick",function(){return m(a),p(n.validarFormulario())}),i()(),t(33,"div",18)(34,"p-table",19),w(35,bi,13,0,"ng-template",null,0,b)(37,Ci,15,9,"ng-template",null,1,b),i()()()(),t(39,"div",11)(40,"div",3)(41,"div",4),o(42,"Registrar Informacion adicional"),i(),t(43,"div",5)(44,"div",6)(45,"label",14),o(46,"Campa\xF1a"),i(),t(47,"input",20),h("ngModelChange",function(s){return m(a),f(n.campana,s)||(n.campana=s),p(s)}),i()(),t(48,"div",6)(49,"label",12),o(50,"Tipo Racimo"),i(),t(51,"p-select",21),h("ngModelChange",function(s){return m(a),f(n.racimoSeleccionado,s)||(n.racimoSeleccionado=s),p(s)}),i()(),t(52,"div",6)(53,"label",12),o(54,"Condicion del Vehiculo"),i(),t(55,"p-select",22),h("ngModelChange",function(s){return m(a),f(n.limpiezaSeleccionado,s)||(n.limpiezaSeleccionado=s),p(s)}),i()()(),t(56,"div",5)(57,"p-button",23),S("click",function(){return m(a),p(n.saveControlRff())}),i(),y(58,"p-button",24),i()()()(),t(59,"p-dialog",25),h("visibleChange",function(s){return m(a),f(n.mostrarErrores,s)||(n.mostrarErrores=s),p(s)}),t(60,"p"),o(61,"Se ha producido las siguientes inconsistencias:"),i(),t(62,"ul",26),w(63,xi,2,1,"li",27),i()(),y(64,"p-confirmDialog")(65,"p-toast",28)}e&2&&(d(4),A("Evaluacion ticket: ",n.numTicket," - Datos Generales"),d(5),_("ngModel",n.proveedor),u("disabled",!0),d(4),_("ngModel",n.transportista),u("disabled",!0),d(9),_("ngModel",n.criterio_calidad.values)("ngModel",n.selectedValue),u("options",n.criterio_calidad),d(4),_("ngModel",n.valor),d(4),_("ngModel",n.factor_castigo),u("disabled",!0),d(2),u("fluid",!1),d(2),u("value",n.evaluacion_calidad)("tableStyle",j(29,hi)),d(13),_("ngModel",n.campana),d(4),_("ngModel",n.racimoSeleccionado),u("options",n.tipoRacimo),d(4),_("ngModel",n.limpiezaSeleccionado),u("options",n.limpieza),d(2),u("fluid",!1),d(),u("fluid",!1),d(),Z(j(30,vi)),_("visible",n.mostrarErrores),u("modal",!0)("closable",!0)("contentStyle",j(31,Si))("baseZIndex",1e4),d(4),u("ngForOf",n.errores))},dependencies:[R,H,L,N,ee,$,Ct,z,xt,q,te,ie,ge,Ie,yt,B,ce],encapsulation:2})};var Ke=class l extends W{constructor(e){super(e,`${k.HOST}/personas`);this.http=e}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var Ei=()=>({standalone:!0}),wi=l=>["/pages/registrar-evaluacion",l];function Mi(l,r){if(l&1&&o(0),l&2){let e=r.$implicit;st(" ",e==null?null:e.paterno," ",e==null?null:e.materno," ",e==null?null:e.nombres," ")}}function Ti(l,r){if(l&1&&o(0),l&2){let e=r.$implicit;st(" ",e==null?null:e.paterno," ",e==null?null:e.materno," ",e==null?null:e.nombres," ")}}function Pi(l,r){if(l&1&&(t(0,"li"),o(1),i()),l&2){let e=r.$implicit;d(),g(e)}}function Vi(l,r){if(l&1&&(t(0,"div",21)(1,"p",22),o(2,"Se han producido las siguientes inconsistencias:"),i(),t(3,"ul",23),w(4,Pi,2,1,"li",24),i()()),l&2){let e=v();d(4),u("ngForOf",e.errores)}}function Ii(l,r){l&1&&(t(0,"tr")(1,"th",25),o(2,"Ticket"),i(),t(3,"th",25),o(4,"Fecha"),i(),t(5,"th",25),o(6,"Peso"),i(),t(7,"th",26),o(8,"Transportista"),i(),t(9,"th",25),o(10,"Vehiculo"),i(),t(11,"th",25),o(12,"Editar"),i(),t(13,"th",25),o(14,"Evaluado"),i()())}function ki(l,r){if(l&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),y(12,"p-button",27),i(),t(13,"td"),y(14,"p-button",28),i()()),l&2){let e=r.$implicit;d(2),A(" ",e.numTicket," "),d(2),g(e.fecha),d(2),g(e.pesoNeto),d(2),g(e.transportista),d(2),g(e.placa),d(2),u("rounded",!0)("text",!0)("routerLink",se(10,wi,e.idPesaje)),d(2),u("rounded",!0)("text",!0)}}function Di(l,r){l&1&&(t(0,"tr")(1,"td",29),o(2,"Sin Datos"),i()())}var Xe=class l{constructor(r,e){this.personaService=r;this.pesoDestare=e}meses=[{name:"ENERO",value:"01"},{name:"FEBRERO",value:"02"},{name:"MARZO",value:"03"},{name:"ABRIL",value:"04"},{name:"MAYO",value:"05"},{name:"JUNIO",value:"06"},{name:"JULIO",value:"07"},{name:"AGOSTO",value:"08"},{name:"SETIEMBRE",value:"09"},{name:"OCTUBRE",value:"10"},{name:"NOVIEMBRE",value:"11"},{name:"DICIEMBRE",value:"12"}];persona;selectedAutoValue=null;autoFilteredValue=[];mesSeleccionado;anio;proveedor;errores=[];errorMessage="";mostrarErrores=!1;carga;ngOnInit(){this.personaService.findAll().subscribe(r=>{this.persona=r.map(e=>{let n=[e?.paterno,e?.materno,e?.nombres].filter(Boolean).map(a=>a.trim());return ht(ae({},e),{nombreCompleto:n.join(" ")})})})}filtrarProveedores(r){let e=r.query?.toLowerCase()??"";if(e.length<4){this.autoFilteredValue=[];return}let n=this.persona.filter(a=>`${a?.paterno??""} ${a?.materno??""} ${a?.nombres??""}`.toLowerCase().includes(e));this.autoFilteredValue=n}shoeProveedor(r){return r&&r.nombreCompleto}buscar(){this.pesoDestare.searchByProveedorAnioMes(this.selectedAutoValue.codigo,this.anio,this.mesSeleccionado.value).subscribe(r=>{this.carga=r,console.log(this.carga),this.proveedor=this.carga[0].proveedor})}validarFormulario(){this.errores=[],this.selectedAutoValue||this.errores.push("No se ha seleccionado el titular."),(!this.anio||this.anio<=0)&&this.errores.push("No se ha ingresado el a\xF1o."),this.mesSeleccionado||this.errores.push("No se ha seleccionado el mes de consulta."),!(this.errores.length>0)&&this.buscar()}static \u0275fac=function(e){return new(e||l)(C(Ke),C(G))};static \u0275cmp=D({type:l,selectors:[["app-consult-proveedor"]],decls:33,vars:15,consts:[["header",""],["body",""],["emptymessage",""],[1,"flex"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],[1,"grid","grid-cols-12","gap-4","grid-cols-12","gap-2"],["for","name3",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],[1,"col-span-12","md:col-span-5"],["placeholder","Buscar proveedor...","display","chip","optionLabel","nombreCompleto",3,"ngModelChange","completeMethod","ngModel","suggestions","forceSelection","dropdown","ngModelOptions"],["pTemplate","item"],["pTemplate","selectedItem"],["for","email3",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],[1,"col-span-12","md:col-span-2"],["pInputText","","id","email3","type","text",3,"ngModelChange","ngModel"],["optionLabel","name","id","state","placeholder","Seeleccionar",1,"w-full",3,"ngModelChange","ngModel","options"],["label","Buscar","icon","pi pi-check",3,"onClick","fluid"],["class","bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4 text-center",4,"ngIf"],[1,"card","mt-3"],[1,"text-xl","mb-2"],["emptyMessage","Sin datos",3,"value","rows","paginator"],[1,"bg-red-100","border","border-red-400","text-red-700","px-4","py-3","rounded","mb-4","text-center"],[1,"font-bold","mb-2"],[1,"list-disc","list-inside","text-left","inline-block"],[4,"ngFor","ngForOf"],["pFrozenColumn","",1,"font-bold",2,"min-width","50px"],["pFrozenColumn","",1,"font-bold",2,"min-width","150px"],["icon","pi pi-file-edit","severity","info","routerLinkActive","router-link-active",3,"rounded","text","routerLink"],["icon","pi pi-check-circle","severity","info",3,"rounded","text"],["colspan","8"]],template:function(e,n){if(e&1){let a=T();t(0,"p-fluid")(1,"div",3)(2,"div",4)(3,"div",5),o(4,"Consulta de Pesos y Evaluaciones de calidad"),i(),t(5,"div",6)(6,"label",7),o(7,"Nombre:"),i(),t(8,"div",8)(9,"p-autoComplete",9),h("ngModelChange",function(s){return m(a),f(n.selectedAutoValue,s)||(n.selectedAutoValue=s),p(s)}),S("completeMethod",function(s){return m(a),p(n.filtrarProveedores(s))}),w(10,Mi,1,3,"ng-template",10)(11,Ti,1,3,"ng-template",11),i()()(),t(12,"div",6)(13,"label",12),o(14,"A\xF1o"),i(),t(15,"div",13)(16,"input",14),h("ngModelChange",function(s){return m(a),f(n.anio,s)||(n.anio=s),p(s)}),i()(),t(17,"label",12),o(18,"Mes"),i(),t(19,"div",13)(20,"p-select",15),h("ngModelChange",function(s){return m(a),f(n.mesSeleccionado,s)||(n.mesSeleccionado=s),p(s)}),i()(),t(21,"p-button",16),S("onClick",function(){return m(a),p(n.validarFormulario())}),i()(),w(22,Vi,5,1,"div",17),i()(),t(23,"div",18)(24,"div",19),o(25),i(),t(26,"p-table",20),w(27,Ii,15,0,"ng-template",null,0,b)(29,ki,15,12,"ng-template",null,1,b)(31,Di,3,0,"ng-template",null,2,b),i()()()}e&2&&(d(9),_("ngModel",n.selectedAutoValue),u("suggestions",n.autoFilteredValue)("forceSelection",!1)("dropdown",!0)("ngModelOptions",j(14,Ei)),d(7),_("ngModel",n.anio),d(4),_("ngModel",n.mesSeleccionado),u("options",n.meses),d(),u("fluid",!1),d(),u("ngIf",n.errores.length>0),d(3),A(" Proveedor: ",n.proveedor," "),d(),u("value",n.carga)("rows",10)("paginator",!0))},dependencies:[R,H,bt,ue,L,N,ee,$,z,q,te,Mt,K,B,ce,me],encapsulation:2})};var Ri=l=>["/pages/registrar-evaluacion",l];function Wi(l,r){l&1&&(t(0,"tr")(1,"th",14),o(2,"Ticket"),i(),t(3,"th",15),o(4,"Fecha"),i(),t(5,"th",16),o(6,"Titular"),i(),t(7,"th",14),o(8,"Peso"),i(),t(9,"th",16),o(10,"Transportista"),i(),t(11,"th",17),o(12,"Vehiculo"),i(),t(13,"th",14),o(14,"Editar"),i(),t(15,"th",14),o(16,"Evaluado"),i()())}function Fi(l,r){if(l&1&&(t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),y(14,"p-button",18),i(),t(15,"td"),y(16,"p-button",19),i()()),l&2){let e=r.$implicit;d(2),A(" ",e.numTicket),d(2),A(" ",e.fecha),d(2),A(" ",e.proveedor),d(2),A(" ",e.pesoNeto),d(2),A(" ",e.transportista),d(2),A(" ",e.placa),d(2),u("routerLink",se(11,Ri,e.idPesaje))("rounded",!0)("text",!0),d(2),u("rounded",!0)("text",!0)}}function ji(l,r){l&1&&(t(0,"tr")(1,"td",20),o(2,"Sin Datos"),i()())}var Je=class l{constructor(r,e){this.pesoDestareService=r;this.service=e}calendarValue=new Date;message;pesoDestare;ngOnInit(){}buscarPesajes(){if(!this.calendarValue){this.service.add({severity:"error",summary:"Error",detail:"Debe seleccionar una fecha v\xE1lida.",life:6e3});return}let r=de(this.calendarValue,"yyyy-MM-dd","en-US");this.pesoDestareService.searchByDate(r).subscribe(e=>{e&&e.length>0?this.pesoDestare=e:(this.service.add({severity:"warn",summary:"Sin resultados",detail:"No se encontraron datos para la fecha seleccionada.",life:5e3}),this.pesoDestare=e)},e=>{this.service.add({severity:"error",summary:"Error de conexi\xF3n",detail:"Ocurri\xF3 un error al consultar los datos.",life:5e3}),console.error("Error al consultar peso destare:",e)})}checkDate(){this.calendarValue||(this.calendarValue=new Date)}static \u0275fac=function(e){return new(e||l)(C(G),C(Q))};static \u0275cmp=D({type:l,selectors:[["app-consult-fecha"]],decls:20,vars:8,consts:[["header",""],["body",""],["emptymessage",""],[1,"flex"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],[1,"grid","grid-cols-12","gap-4","grid-cols-12","gap-2"],["for","email3",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],[1,"col-span-12","md:col-span-2"],[3,"ngModelChange","onBlur","ngModel","dateFormat","showIcon","readonlyInput"],["label","Buscar","icon","pi pi-check",3,"onClick","fluid"],[1,"card","mt-3"],["emptyMessage","Sin datos",3,"value","rows","paginator"],["position","top-right"],["pFrozenColumn","",1,"font-bold",2,"min-width","50px"],["pFrozenColumn","",1,"font-bold",2,"min-width","120px"],["pFrozenColumn","",1,"font-bold",2,"min-width","200px"],["pFrozenColumn","",1,"font-bold",2,"min-width","100px"],["icon","pi pi-file-edit","routerLinkActive","router-link-active","severity","info",3,"routerLink","rounded","text"],["icon","pi pi-check-circle","severity","info",3,"rounded","text"],["colspan","8"]],template:function(e,n){if(e&1){let a=T();t(0,"p-fluid")(1,"div",3)(2,"div",4)(3,"div",5),o(4,"Consulta de Pesos y Evaluaciones de calidad"),i(),t(5,"div",6)(6,"label",7),o(7,"Fecha:"),i(),t(8,"div",8)(9,"p-datepicker",9),h("ngModelChange",function(s){return m(a),f(n.calendarValue,s)||(n.calendarValue=s),p(s)}),S("onBlur",function(){return m(a),p(n.checkDate())}),i()(),t(10,"p-button",10),S("onClick",function(){return m(a),p(n.buscarPesajes())}),i()()()(),t(11,"div",11)(12,"p-table",12),w(13,Wi,17,0,"ng-template",null,0,b)(15,Fi,17,13,"ng-template",null,1,b)(17,ji,3,0,"ng-template",null,2,b),i()()(),y(19,"p-toast",13)}e&2&&(d(9),_("ngModel",n.calendarValue),u("dateFormat","dd/mm/yy")("showIcon",!0)("readonlyInput",!0),d(),u("fluid",!1),d(2),u("value",n.pesoDestare)("rows",10)("paginator",!0))},dependencies:[R,H,ue,L,N,z,q,ie,pe,K],encapsulation:2})};var Ye=class{id_peso_medida;estado;fecha;usuario;id_guia;id_pesaje};var Ze=class{id_guia;fecha_emision;serie;numero;fecha_inicio;partida;destino;motivo_traslado;estado;observacion;codigo_destinatario;num_doc_destinatario;version;usuario;presintos;codigo_et;codigo_cond;id_vehiculo;pedido};var Qe=class l extends W{constructor(e){super(e,`${k.HOST}/guia_remision`);this.http=e}listarTicketsPorEstado(){return this.http.get(`${this.url}/facturado`)}searchGuiaPorSerieNumero(e,n,a){return this.http.get(`${this.url}/buscar/${e}/${n}/${a}`)}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var re=class l extends W{constructor(e){super(e,`${k.HOST}/peso_medidas`);this.http=e}searchByDate(e){return this.http.get(`${this.url}/search/date?date=${e}`)}guardar(e){return this.http.post(this.url,e,{observe:"response"})}anularPesoMedida(e){let n=`${this.url}/${e}/anular`;return this.http.put(n,{})}generatePdf(e){return this.http.get(`${this.url}/pdf/${e}`,{responseType:"arraybuffer"})}static \u0275fac=function(n){return new(n||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var Lt=()=>({width:"auto"});function Bi(l,r){l&1&&(t(0,"tr")(1,"th"),o(2,"Codigo"),i(),t(3,"th"),o(4,"Fecha"),i(),t(5,"th"),o(6,"Num. Ticket"),i(),t(7,"th"),o(8,"Cliente"),i(),t(9,"th"),o(10,"P.Ingreso"),i(),t(11,"th"),o(12,"P.Salida"),i(),t(13,"th"),o(14,"P.Neto"),i()())}function Oi(l,r){if(l&1){let e=T();t(0,"tr",43),S("dblclick",function(){m(e);let a=v();return p(a.seleccionarTicket())}),t(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),o(14),i(),y(15,"td"),i()}if(l&2){let e=r.$implicit;u("pSelectableRow",e),d(2),g(e.idPesaje),d(2),g(e.fecha),d(2),g(e.numTicket),d(2),g(e.proveedor),d(2),g(e.pesoIngreso),d(2),g(e.pesoSalida),d(2),g(e.pesoNeto)}}function Ai(l,r){l&1&&(t(0,"tr")(1,"td",44),o(2,"Sin Datos"),i()())}function Ni(l,r){if(l&1){let e=T();xe(0),t(1,"div",15)(2,"label",45),o(3,"Serie:"),i(),t(4,"p-select",46),h("ngModelChange",function(a){m(e);let c=v();return f(c.serieSeleccionado,a)||(c.serieSeleccionado=a),p(a)}),i()(),t(5,"div",15)(6,"label",45),o(7,"N\xFAmero:"),i(),t(8,"input",47),h("ngModelChange",function(a){m(e);let c=v();return f(c.numero_buscar,a)||(c.numero_buscar=a),p(a)}),i()(),t(9,"div",31)(10,"p-button",32),S("onClick",function(){m(e);let a=v();return p(a.buscarGuiaRemision())}),i()(),ye()}if(l&2){let e=v();d(4),_("ngModel",e.serieSeleccionado),u("options",e.serie),d(4),_("ngModel",e.numero_buscar),d(2),u("fluid",!0)}}function Hi(l,r){l&1&&(t(0,"tr")(1,"th"),o(2,"Codigo"),i(),t(3,"th"),o(4,"Fecha"),i(),t(5,"th"),o(6,"Serie"),i(),t(7,"th"),o(8,"Numero"),i(),t(9,"th"),o(10,"Cliente"),i(),t(11,"th"),o(12,"Documento"),i(),t(13,"th"),o(14,"Cantidad"),i(),t(15,"th"),o(16,"UM"),i(),t(17,"th"),o(18,"Descripcion"),i(),t(19,"th"),o(20,"Estado"),i()())}function Gi(l,r){if(l&1){let e=T();t(0,"tr",43),S("dblclick",function(){m(e);let a=v();return p(a.seleccionarGuia())}),t(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),o(14),i(),t(15,"td"),o(16),i(),t(17,"td"),o(18),i()()}if(l&2){let e=r.$implicit;u("pSelectableRow",e),d(2),g(e.idGuia),d(2),g(e.fechaEmision),d(2),g(e.serie),d(2),g(e.numero),d(2),g(e.proveedor),d(2),g(e.numeroDocumento),d(2),g(e.pesoBruto),d(2),g(e.unidadMedida),d(2),g(e.descripcion)}}function Ui(l,r){l&1&&(t(0,"tr")(1,"td",48),o(2,"No se encontraron comprobantes"),i()())}var $e=class l{constructor(r,e,n,a){this.pesoDestareService=r;this.guiaRemisionService=e;this.pesoMedidaService=n;this.router=a}displayModal=!1;displayModal2=!1;pesoDestare;numTicket;ticketSeleccionado={};ticketTemporal={};estadoSeleccionado="No Facturado";serieSeleccionado;guia_remision=[];estado;serie;numero_guia;serie_guia;id_guia;numero_buscar;guiaTemporal;guiaSeleccionada;guiaSeleccionadaFinal=null;serie_numero;calendarValue=new Date;nuevoId;ngOnInit(){this.guiaRemisionService.listarTicketsPorEstado().subscribe(r=>{this.guia_remision=r}),this.estado=[{label:"No Facturado",value:"No Facturado"},{label:"Facturado",value:"Facturado"}],this.serie=[{label:"TTT1",value:"TTT1"},{label:"TTT2",value:"TTT2"}]}abrirModal(){this.displayModal=!0,this.ticketTemporal={},this.numTicket="",this.pesoDestare=[]}buscarTicket(){this.pesoDestareService.listarPesajePorNumTicket(this.numTicket).subscribe(r=>{this.pesoDestare=r})}abrirModal2(){this.displayModal2=!0,this.estadoSeleccionado="No Facturado",this.guiaRemisionService.listarTicketsPorEstado().subscribe(r=>{this.guia_remision=r}),this.serieSeleccionado=null,this.numero_buscar=null}manejarCambioEstado(){this.ticketTemporal=null,this.estadoSeleccionado==="Facturado"?(this.guia_remision=[],this.numTicket=""):this.guiaRemisionService.listarTicketsPorEstado().subscribe({next:r=>{this.guia_remision=r},error:r=>{console.error("Error al cargar gu\xEDas de remisi\xF3n:",r)}})}seleccionarGuia(){this.ticketTemporal?(this.guiaSeleccionadaFinal=this.ticketTemporal,this.displayModal2=!1,this.ticketTemporal=null,this.serie_numero=this.guiaSeleccionadaFinal.serie+"-"+this.guiaSeleccionadaFinal.numero,this.serie_guia=this.guiaSeleccionadaFinal.serie,this.numero_guia=this.guiaSeleccionadaFinal.numero,this.id_guia=this.guiaSeleccionadaFinal.idGuia):console.warn("Debe seleccionar una gu\xEDa para continuar.")}seleccionarTicket(){this.ticketTemporal&&this.ticketTemporal.idPesaje?(this.ticketSeleccionado=ae({},this.ticketTemporal),this.displayModal=!1):alert("Seleccione un ticket antes de continuar")}buscarGuiaRemision(){this.guiaRemisionService.searchGuiaPorSerieNumero("SI","TTT1",this.numero_buscar).subscribe(r=>{this.guia_remision=r})}checkDate(){this.calendarValue||(this.calendarValue=new Date)}operarPesosMedidas(){let r=de(this.calendarValue,"yyyy-MM-dd","en-US"),e=new oe;e.id_pesaje=this.ticketSeleccionado.idPesaje;let n=new Ze;n.id_guia=this.id_guia;let a=new Ye;a.estado="EMITIDO",a.fecha=r,a.usuario="VEUSEBIO",a.id_guia=n,a.id_pesaje=e,this.pesoMedidaService.guardar(a).subscribe(c=>{let s=c.headers.get("Location");s?(this.nuevoId=Number(s.split("/").pop()),console.log("Nuevo ID:",this.nuevoId),this.router.navigate(["/pages/resultado",this.nuevoId])):console.warn("No se recibi\xF3 la cabecera Location")})}static \u0275fac=function(e){return new(e||l)(C(G),C(Qe),C(re),C(we))};static \u0275cmp=D({type:l,selectors:[["app-pesomedida"]],decls:116,vars:63,consts:[["header",""],["body",""],["emptymessage",""],[1,"flex"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],["header","Datos del Ticket",3,"toggleable"],[1,"grid","grid-cols-12","gap-4","grid-cols-12","gap-2"],["for","email3",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],[1,"col-span-12","md:col-span-3"],["iconPosition","left"],["pInputText","","type","text","placeholder","00290084",3,"ngModelChange","ngModel"],[1,"pi","pi-search",2,"cursor","pointer",3,"click"],[3,"ngModelChange","onBlur","ngModel","dateFormat","showIcon","readonlyInput"],[1,"flex","flex-col","md:flex-row","gap-6","mt-4"],[1,"flex","flex-wrap","gap-2","w-full"],["for","firstname2"],["pInputText","","id","firstname2","type","text",3,"ngModelChange","disabled","ngModel"],["pInputText","","id","firstname2","type","text",3,"ngModelChange","hidden","ngModel"],["for","lastname2"],["pInputText","","id","lastname2","type","text",3,"ngModelChange","disabled","ngModel"],["pTextarea","","placeholder","Observaciones","rows","3","cols","30",3,"ngModelChange","ngModel","autoResize","disabled"],["header","Datos de la Guia",3,"toggleable"],["pInputText","","type","text","placeholder","TTT1-002589",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-12","gap-4","grid-cols-12","gap-2","mt-4"],["pInputText","","id","lastname2","type","text",3,"ngModelChange","hidden","ngModel"],["label","Guardar","icon","pi pi-check",3,"onClick","fluid"],["header","Tickets Pendientes de Pesos y Medidas",3,"visibleChange","visible","modal","closable"],[1,"flex","flex-col","md:flex-row","gap-6"],["for","zip"],["pInputText","","id","zip","type","text","placeholder","00297852",3,"ngModelChange","ngModel"],[1,"flex","flex-wrap","gap-2","w-full","self-end"],["icon","pi pi-search","label","Buscar",1,"w-full","flex","justify-center",3,"onClick","fluid"],[1,"flex","mt-4"],[1,"flex","flex-col","gap-6"],["emptyMessage","Sin datos","selectionMode","single","dataKey","idPesaje",3,"selectionChange","value","rows","paginator","selection"],["icon","pi pi-check","label","Seleccionar",3,"onClick","fluid"],["header","Gu\xEDa de remisi\xF3n pendientes de facturar",3,"visibleChange","visible","modal","closable"],[1,"flex","flex-wrap","gap-2"],["for","state"],["id","state","optionValue","value","optionLabel","label",3,"ngModelChange","onChange","ngModel","options"],[4,"ngIf"],["selectionMode","single","dataKey","idGuia",3,"selectionChange","value","rows","paginator","selection"],[3,"dblclick","pSelectableRow"],["colspan","9"],["for","numTicket"],["id","state","placeholder","Seleccionar","optionLabel","label",3,"ngModelChange","ngModel","options"],["pInputText","","id","numTicket","type","text","placeholder","numero",3,"ngModelChange","ngModel"],["colspan","10"]],template:function(e,n){if(e&1){let a=T();t(0,"p-fluid")(1,"div",3)(2,"div",4)(3,"div",5),o(4,"Registrar Pesos y Medidas"),i(),t(5,"p-panel",6)(6,"div",7)(7,"label",8),o(8,"Ticket: "),i(),t(9,"div",9)(10,"p-iconfield",10)(11,"input",11),h("ngModelChange",function(s){return m(a),f(n.ticketSeleccionado.numTicket,s)||(n.ticketSeleccionado.numTicket=s),p(s)}),i(),t(12,"p-inputicon",12),S("click",function(){return m(a),p(n.abrirModal())}),i()()(),t(13,"label",8),o(14,"Fecha: "),i(),t(15,"div",9)(16,"p-datepicker",13),h("ngModelChange",function(s){return m(a),f(n.calendarValue,s)||(n.calendarValue=s),p(s)}),S("onBlur",function(){return m(a),p(n.checkDate())}),i()()(),t(17,"div",14)(18,"div",15)(19,"label",16),o(20,"Cliente:"),i(),t(21,"input",17),h("ngModelChange",function(s){return m(a),f(n.ticketSeleccionado.proveedor,s)||(n.ticketSeleccionado.proveedor=s),p(s)}),i(),t(22,"input",18),h("ngModelChange",function(s){return m(a),f(n.ticketSeleccionado.idPesaje,s)||(n.ticketSeleccionado.idPesaje=s),p(s)}),i()(),t(23,"div",15)(24,"label",19),o(25,"Producto:"),i(),t(26,"input",20),h("ngModelChange",function(s){return m(a),f(n.ticketSeleccionado.descripcion,s)||(n.ticketSeleccionado.descripcion=s),p(s)}),i()()(),t(27,"div",14)(28,"div",15)(29,"label",16),o(30,"Empresa Transporte:"),i(),t(31,"input",17),h("ngModelChange",function(s){return m(a),f(n.ticketSeleccionado.transportista,s)||(n.ticketSeleccionado.transportista=s),p(s)}),i()(),t(32,"div",15)(33,"label",19),o(34,"Conductor:"),i(),t(35,"input",20),h("ngModelChange",function(s){return m(a),f(n.ticketSeleccionado.conductores,s)||(n.ticketSeleccionado.conductores=s),p(s)}),i()(),t(36,"div",15)(37,"label",19),o(38,"Licencia:"),i(),t(39,"input",20),h("ngModelChange",function(s){return m(a),f(n.ticketSeleccionado.licencia,s)||(n.ticketSeleccionado.licencia=s),p(s)}),i()()(),t(40,"div",14)(41,"div",15)(42,"label",16),o(43,"P. Ingreso(KG):"),i(),t(44,"input",17),h("ngModelChange",function(s){return m(a),f(n.ticketSeleccionado.pesoIngreso,s)||(n.ticketSeleccionado.pesoIngreso=s),p(s)}),i()(),t(45,"div",15)(46,"label",19),o(47,"P. Salida(KG):"),i(),t(48,"input",20),h("ngModelChange",function(s){return m(a),f(n.ticketSeleccionado.pesoSalida,s)||(n.ticketSeleccionado.pesoSalida=s),p(s)}),i()(),t(49,"div",15)(50,"label",19),o(51,"P. Neto(KG):"),i(),t(52,"input",20),h("ngModelChange",function(s){return m(a),f(n.ticketSeleccionado.pesoNeto,s)||(n.ticketSeleccionado.pesoNeto=s),p(s)}),i()()(),t(53,"div",14)(54,"div",15)(55,"label",19),o(56,"Observacion:"),i(),t(57,"textarea",21),h("ngModelChange",function(s){return m(a),f(n.ticketSeleccionado.observaciones,s)||(n.ticketSeleccionado.observaciones=s),p(s)}),i()()()(),t(58,"p-panel",22)(59,"div",7)(60,"label",8),o(61,"Guia de Remision: "),i(),t(62,"div",9)(63,"p-iconfield",10)(64,"input",23),h("ngModelChange",function(s){return m(a),f(n.serie_numero,s)||(n.serie_numero=s),p(s)}),i(),t(65,"p-inputicon",12),S("click",function(){return m(a),p(n.abrirModal2())}),i()()()(),t(66,"div",24)(67,"label",8),o(68,"Serie: "),i(),t(69,"div",9)(70,"input",20),h("ngModelChange",function(s){return m(a),f(n.serie_guia,s)||(n.serie_guia=s),p(s)}),i(),t(71,"input",25),h("ngModelChange",function(s){return m(a),f(n.id_guia,s)||(n.id_guia=s),p(s)}),i()(),t(72,"label",8),o(73,"Numero: "),i(),t(74,"div",9)(75,"input",20),h("ngModelChange",function(s){return m(a),f(n.numero_guia,s)||(n.numero_guia=s),p(s)}),i()()()(),t(76,"p-button",26),S("onClick",function(){return m(a),p(n.operarPesosMedidas())}),i()()()(),t(77,"p-dialog",27),h("visibleChange",function(s){return m(a),f(n.displayModal,s)||(n.displayModal=s),p(s)}),t(78,"p-fluid")(79,"div",28)(80,"div",15)(81,"label",29),o(82,"Numero Ticket"),i(),t(83,"input",30),h("ngModelChange",function(s){return m(a),f(n.numTicket,s)||(n.numTicket=s),p(s)}),i()(),t(84,"div",31)(85,"p-button",32),S("onClick",function(){return m(a),p(n.buscarTicket())}),i()()(),t(86,"div",33)(87,"div",34)(88,"p-table",35),h("selectionChange",function(s){return m(a),f(n.ticketTemporal,s)||(n.ticketTemporal=s),p(s)}),w(89,Bi,15,0,"ng-template",null,0,b)(91,Oi,16,8,"ng-template",null,1,b)(93,Ai,3,0,"ng-template",null,2,b),i()()(),t(95,"div",28)(96,"p-button",36),S("onClick",function(){return m(a),p(n.seleccionarTicket())}),i()()()(),t(97,"p-dialog",37),h("visibleChange",function(s){return m(a),f(n.displayModal2,s)||(n.displayModal2=s),p(s)}),t(98,"p-fluid")(99,"div",28)(100,"div",38)(101,"label",39),o(102,"Estado:"),i(),t(103,"p-select",40),h("ngModelChange",function(s){return m(a),f(n.estadoSeleccionado,s)||(n.estadoSeleccionado=s),p(s)}),S("onChange",function(){return m(a),p(n.manejarCambioEstado())}),i()(),w(104,Ni,11,4,"ng-container",41),i(),t(105,"div",33)(106,"div",34)(107,"p-table",42),h("selectionChange",function(s){return m(a),f(n.ticketTemporal,s)||(n.ticketTemporal=s),p(s)}),w(108,Hi,21,0,"ng-template",null,0,b)(110,Gi,19,10,"ng-template",null,1,b)(112,Ui,3,0,"ng-template",null,2,b),i()()(),t(114,"div",28)(115,"p-button",36),S("onClick",function(){return m(a),p(n.seleccionarGuia())}),i()()()()}e&2&&(d(5),u("toggleable",!0),d(6),_("ngModel",n.ticketSeleccionado.numTicket),d(5),_("ngModel",n.calendarValue),u("dateFormat","dd/mm/yy")("showIcon",!0)("readonlyInput",!0),d(5),u("disabled",!0),_("ngModel",n.ticketSeleccionado.proveedor),d(),u("hidden",!0),_("ngModel",n.ticketSeleccionado.idPesaje),d(4),u("disabled",!0),_("ngModel",n.ticketSeleccionado.descripcion),d(5),u("disabled",!0),_("ngModel",n.ticketSeleccionado.transportista),d(4),u("disabled",!0),_("ngModel",n.ticketSeleccionado.conductores),d(4),u("disabled",!0),_("ngModel",n.ticketSeleccionado.licencia),d(5),u("disabled",!0),_("ngModel",n.ticketSeleccionado.pesoIngreso),d(4),u("disabled",!0),_("ngModel",n.ticketSeleccionado.pesoSalida),d(4),u("disabled",!0),_("ngModel",n.ticketSeleccionado.pesoNeto),d(5),_("ngModel",n.ticketSeleccionado.observaciones),u("autoResize",!0)("disabled",!0),d(),u("toggleable",!0),d(6),_("ngModel",n.serie_numero),d(6),u("disabled",!0),_("ngModel",n.serie_guia),d(),u("hidden",!0),_("ngModel",n.id_guia),d(4),u("disabled",!0),_("ngModel",n.numero_guia),d(),u("fluid",!1),d(),Z(j(61,Lt)),_("visible",n.displayModal),u("modal",!0)("closable",!0),d(6),_("ngModel",n.numTicket),d(2),u("fluid",!0),d(3),u("value",n.pesoDestare)("rows",10)("paginator",!0),_("selection",n.ticketTemporal),d(8),u("fluid",!1),d(),Z(j(62,Lt)),_("visible",n.displayModal2),u("modal",!0)("closable",!0),d(6),_("ngModel",n.estadoSeleccionado),u("options",n.estado),d(),u("ngIf",n.estadoSeleccionado==="Facturado"),d(3),u("value",n.guia_remision)("rows",10)("paginator",!0),_("selection",n.ticketTemporal),d(8),u("fluid",!1))},dependencies:[R,H,Ve,L,N,ee,$,z,q,te,pe,Tt,Te,Pe,ge,Pt,B,me],encapsulation:2})};var Ot=Ht(Bt());function zi(l,r){l&1&&(t(0,"tr")(1,"th",14),o(2,"Codigo"),i(),t(3,"th",15),o(4,"Fecha"),i(),t(5,"th",16),o(6,"Cliente"),i(),t(7,"th",16),o(8,"Transportista"),i(),t(9,"th",17),o(10,"Placa"),i(),t(11,"th",14),o(12,"Guia Remision"),i(),t(13,"th",14),o(14,"Peso Permitido"),i(),t(15,"th",14),o(16,"Peso Transportado"),i(),t(17,"th",14),o(18,"Descargar PDF"),i(),t(19,"th",14),o(20,"Estado"),i(),t(21,"th",14),o(22,"Acciones"),i()())}function qi(l,r){if(l&1){let e=T();t(0,"tr")(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td"),o(10),i(),t(11,"td"),o(12),i(),t(13,"td"),o(14),i(),t(15,"td"),o(16),i(),t(17,"td")(18,"p-button",18),S("onClick",function(){let a=m(e).$implicit,c=v();return p(c.descargarPdf(a.idPesoMedida))}),i(),t(19,"p-button",19),S("onClick",function(){let a=m(e).$implicit,c=v();return p(c.imprimirPdf(a.idPesoMedida))}),i()(),t(20,"td"),y(21,"p-tag",20),i(),t(22,"td")(23,"p-button",21),S("click",function(){let a=m(e).$implicit,c=v();return p(c.eliminarPesoMedida(a.idPesoMedida))}),i()()()}if(l&2){let e=r.$implicit,n=v();d(2),g(e.idPesoMedida),d(2),g(e.fecha),d(2),g(e.proveedor),d(2),g(e.transportista),d(2),lt("",e.placaPrincipal,"/",e.placaSecundario),d(2),lt("",e.serie,"/",e.numero),d(2),g(e.pesoPermitido),d(2),g(e.pesoSalida),d(2),u("rounded",!0)("text",!0),d(),u("rounded",!0)("text",!0),d(2),u("value",e.estado)("severity",n.getSeverity(e.estado)),d(2),u("disabled",n.isDeleteDisabled(e.estado))("rounded",!0)("outlined",!0)}}function Ki(l,r){l&1&&(t(0,"tr")(1,"td",22),o(2,"Sin Datos"),i()())}var et=class l{constructor(r,e,n){this.pesoMedidaService=r;this.service=e;this.confirmationService=n}calendarValue=new Date;pesosMedidas;pdfSrc;disabledButton=!1;ngOnInit(){}buscarPesosMedidas(){let r=de(this.calendarValue,"yyyy-MM-dd","en-US");this.pesoMedidaService.searchByDate(r).subscribe(e=>{e&&e.length?this.pesosMedidas=e:(this.service.add({severity:"error",summary:"Sin resultados",detail:"No se encontraron datos para la fecha seleccionada.",life:5e3}),this.pesosMedidas=e)},e=>{this.service.add({severity:"error",summary:"Error de conexi\xF3n",detail:"Ocurri\xF3 un error al consultar los datos.",life:5e3}),console.error("Error al consultar peso destare:",e)})}checkDate(){this.calendarValue||(this.calendarValue=new Date)}descargarPdf(r){this.pesoMedidaService.generatePdf(r).subscribe({next:e=>{let n=new Blob([e],{type:"application/pdf"});(0,Ot.saveAs)(n,`peso_medida_${r}.pdf`),this.service.add({severity:"success",summary:"Descarga exitosa",detail:`El PDF de la medida ${r} se descarg\xF3 correctamente.`})},error:e=>{console.error("Error al generar PDF:",e),this.service.add({severity:"error",summary:"Error",detail:"No se pudo generar el PDF. Int\xE9ntalo nuevamente."})}})}imprimirPdf(r){let e=window.open("","_blank");this.pesoMedidaService.generatePdf(r).subscribe({next:n=>{let a=new Blob([n],{type:"application/pdf"}),c=URL.createObjectURL(a);try{e?e.location.href=c:window.location.href=c}finally{setTimeout(()=>URL.revokeObjectURL(c),5e3)}},error:n=>{console.error("Error al generar PDF:",n),e&&e.close(),this.mostrarError("No se pudo generar el PDF. Int\xE9ntalo nuevamente.")}})}mostrarError(r){alert(r)}getSeverity(r){switch(r){case"EMITIDO":return"success";case"ANULADO":return"warn";default:return"info"}}isDeleteDisabled(r){return r==="ANULADO"}eliminarPesoMedida(r){this.confirmationService.confirm({target:event.target,message:"Esta seguro que quiere eliminar?",header:"Eliminacion de Peso Medida",closable:!0,closeOnEscape:!0,icon:"pi pi-exclamation-triangle",rejectButtonProps:{label:"Cancelar",severity:"secondary",outlined:!0},acceptButtonProps:{label:"Si"},accept:()=>{this.pesoMedidaService.anularPesoMedida(r).subscribe({}),this.service.add({severity:"success",summary:"Exito",detail:"Peso Medida Anulado",life:5e3}),this.buscarPesosMedidas()}})}static \u0275fac=function(e){return new(e||l)(C(re),C(Q),C(Me))};static \u0275cmp=D({type:l,selectors:[["app-consultpesomedida"]],decls:21,vars:8,consts:[["header",""],["body",""],["emptymessage",""],[1,"flex"],[1,"card","flex","flex-col","gap-6","w-full"],[1,"font-semibold","text-xl"],[1,"grid","grid-cols-12","gap-4","grid-cols-12","gap-2"],["for","email3",1,"flex","items-center","col-span-12","mb-2","md:col-span-2","md:mb-0"],[1,"col-span-12","md:col-span-2"],[3,"ngModelChange","onBlur","ngModel","showIcon","readonlyInput","dateFormat"],["label","Buscar","icon","pi pi-check",3,"onClick","fluid"],[1,"card","mt-3"],["emptyMessage","Sin datos",3,"value","rows","paginator"],["position","top-right"],["pFrozenColumn","",1,"font-bold",2,"min-width","50px"],["pFrozenColumn","",1,"font-bold",2,"min-width","120px"],["pFrozenColumn","",1,"font-bold",2,"min-width","200px"],["pFrozenColumn","",1,"font-bold",2,"min-width","100px"],["icon","pi pi-download","tooltipPosition","top","pTooltip","Descargar",3,"onClick","rounded","text"],["icon","pi pi-print","tooltipPosition","top","pTooltip","Imprimir",3,"onClick","rounded","text"],[3,"value","severity"],["icon","pi pi-trash","severity","danger",3,"click","disabled","rounded","outlined"],["colspan","11"]],template:function(e,n){if(e&1){let a=T();t(0,"p-fluid")(1,"div",3)(2,"div",4)(3,"div",5),o(4,"Consulta de Pesos y Medidas"),i(),t(5,"div",6)(6,"label",7),o(7,"Fecha:"),i(),t(8,"div",8)(9,"p-datepicker",9),h("ngModelChange",function(s){return m(a),f(n.calendarValue,s)||(n.calendarValue=s),p(s)}),S("onBlur",function(){return m(a),p(n.checkDate())}),i()(),t(10,"p-button",10),S("onClick",function(){return m(a),p(n.buscarPesosMedidas())}),i()()()(),t(11,"div",11)(12,"p-table",12),w(13,zi,23,0,"ng-template",null,0,b)(15,qi,24,19,"ng-template",null,1,b)(17,Ki,3,0,"ng-template",null,2,b),i()()(),y(19,"p-confirmDialog")(20,"p-toast",13)}e&2&&(d(9),_("ngModel",n.calendarValue),u("showIcon",!0)("readonlyInput",!0)("dateFormat","dd/mm/yy"),d(),u("fluid",!1),d(2),u("value",n.pesosMedidas)("rows",10)("paginator",!0))},dependencies:[R,H,ue,L,N,z,q,ie,pe,wt,Ie,kt,B],encapsulation:2})};var tt=class l extends W{privilegioChange=new le;constructor(r){super(r,`${k.HOST}/privilegios`)}getUsuarioPrivilegio(r){return this.http.post(`${this.url}/user`,r)}getPrivilegioChange(){return this.privilegioChange.asObservable()}setPrivilegioChange(r){this.privilegioChange.next(r)}static \u0275fac=function(e){return new(e||l)(P(I))};static \u0275prov=V({token:l,factory:l.\u0275fac,providedIn:"root"})};var J=(l,r)=>{let e=Ce(Dt),n=Ce(tt),a=Ce(we);if(!e.isLogged())return e.logout(),!1;let c=new Rt,s=sessionStorage.getItem(k.TOKEN_NAME);if(c.isTokenExpired(s))return e.logout(),!1;{let x=c.decodeToken(s).sub;return n.getUsuarioPrivilegio(x).pipe(vt(E=>{n.setPrivilegioChange(E);let U=l.data.privilegio;return E.some(O=>O.descripcion===U)?!0:(a.navigate(["/pages/not-403"]),!1)}))}};var it=class l{static \u0275fac=function(e){return new(e||l)};static \u0275cmp=D({type:l,selectors:[["app-not403"]],decls:13,vars:0,consts:[[1,"flex","flex-col","items-center","justify-center"],[2,"border-radius","56px","padding","0.3rem","background","linear-gradient(180deg, rgba(247, 149, 48, 0.4) 10%, rgba(247, 149, 48, 0) 30%)"],[1,"w-full","bg-surface-0","dark:bg-surface-900","py-20","px-8","sm:px-20","flex","flex-col","items-center",2,"border-radius","53px"],[1,"gap-4","flex","flex-col","items-center"],[1,"flex","justify-center","items-center","border-2","border-orange-500","rounded-full",2,"width","3.2rem","height","3.2rem"],[1,"text-orange-500","pi","pi-fw","pi-lock","text-2xl!"],[1,"text-surface-900","dark:text-surface-0","font-bold","text-4xl","lg:text-5xl","mb-2"],[1,"text-muted-color","mb-8"],["src","https://primefaces.org/cdn/templates/sakai/auth/asset-access.svg","alt","Access denied","width","80%",1,"mb-8"],[1,"col-span-12","mt-8","text-center"],["label","Go to Dashboard","routerLink","/pages/dashboard","severity","warn"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),y(5,"i",5),i(),t(6,"h1",6),o(7,"Acceso denegado"),i(),t(8,"span",7),o(9,"No tienes los permisos necesarios. Ponte en contacto con los administradores."),i(),y(10,"img",8),t(11,"div",9),y(12,"p-button",10),i()()()()())},dependencies:[R,L,K],encapsulation:2})};var Xi=()=>["/pages/reg-peso-medida"],nt=class l{constructor(r,e){this.route=r;this.pesoMedidaService=e}id_Peso_Medida;ngOnInit(){this.route.params.subscribe(r=>{this.id_Peso_Medida=r.id_peso_medida})}imprimir(r){this.pesoMedidaService.generatePdf(r).subscribe({next:e=>{let n=new Blob([e],{type:"application/pdf"}),a=URL.createObjectURL(n),c=window.open("","_blank","width=900,height=700,toolbar=yes,scrollbars=yes,resizable=yes");c?(c.document.write(`
          <html>
            <head><title>PDF ${r}</title></head>
            <body style="margin:0">
              <embed src="${a}" type="application/pdf" width="100%" height="100%" />
              <script>
                window.onload = function() {
                  setTimeout(() => {
                    window.print();
                  }, 1000);
                };
              <\/script>
            </body>
          </html>
        `),c.document.close()):alert("El navegador bloque\xF3 la apertura de una nueva ventana. Habilita popups."),setTimeout(()=>URL.revokeObjectURL(a),5e3)},error:e=>{console.error("Error al generar PDF",e),alert("No se pudo generar el PDF. Intenta nuevamente.")}})}static \u0275fac=function(e){return new(e||l)(C(Ee),C(re))};static \u0275cmp=D({type:l,selectors:[["app-detallepesomedida"]],decls:17,vars:5,consts:[[1,"flex","justify-start","w-full"],[1,"card","flex","flex-col","gap-4","w-full","p-4","border","border-green-300","rounded-md","shadow-md","bg-green-50"],[1,"font-semibold","text-xl","text-green-800"],[1,"grid","grid-cols-12","gap-2","items-center"],[1,"col-span-12","md:col-span-2","font-medium","text-green-700"],[1,"col-span-12","md:col-span-10","text-green-900"],[1,"flex","gap-4","justify-start","mt-4"],["label","Nuevo","icon","pi pi-check",3,"routerLink","fluid"],["label","Imprimir","icon","pi pi-print",3,"onClick","fluid"]],template:function(e,n){e&1&&(t(0,"p-fluid")(1,"div",0)(2,"div",1)(3,"div",2),o(4," Peso y Medida Guardado: "),i(),t(5,"div",3)(6,"label",4),o(7,"Tipo:"),i(),t(8,"div",5),o(9,"Peso y Medida"),i(),t(10,"label",4),o(11,"N\xFAmero:"),i(),t(12,"div",5),o(13),i()(),t(14,"div",6),y(15,"p-button",7),t(16,"p-button",8),S("onClick",function(){return n.imprimir(n.id_Peso_Medida)}),i()()()()()),e&2&&(d(13),g(n.id_Peso_Medida),d(2),u("routerLink",j(4,Xi))("fluid",!0),d(),u("fluid",!0))},dependencies:[R,L,N,K,B],encapsulation:2})};var io=[{path:"dashboard",component:Be,canActivate:[J],data:{privilegio:"EVALUACION_WEB_CONSULTA"}},{path:"evaluacion",component:Oe,canActivate:[J],data:{privilegio:"EVALUACION_WEB_REGISTRO"}},{path:"registrar-evaluacion/:id_pesaje",component:qe,canActivate:[J],data:{privilegio:"EVALUACION_WEB_REGISTRO"}},{path:"consult-proveedor",component:Xe,canActivate:[J],data:{privilegio:"EVALUACION_WEB_CONSULTA"}},{path:"consult-fecha",component:Je,canActivate:[J],data:{privilegio:"EVALUACION_WEB_CONSULTA"}},{path:"reg-peso-medida",component:$e,canActivate:[J],data:{privilegio:"EVALUACION_WEB_REG_PESO_MEDIDA"}},{path:"consult-pesomedida",component:et,canActivate:[J],data:{privilegio:"EVALUACION_WEB_CONSULTA_PESO_MEDIDA"}},{path:"resultado/:id_peso_medida",component:nt,canActivate:[J],data:{privilegio:"EVALUACION_WEB_CONSULTA_PESO_MEDIDA"}},{path:"vehiculo",component:Fe,canActivate:[J],data:{privilegio:"EVALUACION_WEB_CONSULTA"}},{path:"not-403",component:it}];export{io as pagesRoutes};
